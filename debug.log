
--------------------------------------------------------------------------------
-- Begin ConvertFrom-StencilTemplate
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Convert-StringToToken
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Get-TagStyle
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- End Get-TagStyle
--------------------------------------------------------------------------------
Template is 521 characters
Template contains 32 lines

--------------------------------------------------------------------------------
-- Begin Set-StartPosition
--------------------------------------------------------------------------------
Setting Start Index => 0
Setting Start Column => 0
Setting Start Line => -1

--------------------------------------------------------------------------------
-- End Set-StartPosition
--------------------------------------------------------------------------------
-- {{{ -Line------------------------------------------------------------------------------
No Carriage Return found
=================================== Line 000 ====================================
Current line: '<%\#\ code:\ language=eps\ \#%>'
Split line into 4 words
-- {{{ -Word '<%\#' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%# code: language=eps #%>
|  ^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (0) scanned in the input so far
|- Index:     0
|- Line:      0
|- Cursor:    0
|- Column:    0
|- ---
|- Start:    Line: -1:0 - Index 0]
|- End:      Line: 0:0 - Index 0]
|- ---
|- This is word 1 of 4 in this line
|- Is first word:  True
|- Is last word:  
|- Previous word:  []
|- Current word:   [<%#] <---
|- Next word:      [code:]
|- ---
|- State:     TEXT
|- Content:   []
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: Start tag --
- Characters found after start tag
Characters found is a Prefix
Check condition when state is TEXT
-- {{{ START TAG :: default --
Content is empty

--------------------------------------------------------------------------------
-- Begin Set-StartPosition
--------------------------------------------------------------------------------
Setting Start Index => 0
Setting Start Column => 0
Setting Start Line => 0

--------------------------------------------------------------------------------
-- End Set-StartPosition
--------------------------------------------------------------------------------
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%# code: language=eps #%>
|  ^
+------------------------------------------------------ }}} --

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 0
After advancing : 3

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 0
After advancing : 3

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
STATE CHANGE: TEXT -> OPEN
- Store current word as prevWord
Finished scanning word [<%#]
-- }}} --

-- {{{ -Word 'code:' --
+-- {{{ -Column (3)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%# code: language=eps #%>
|  --^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (1) scanned in the input so far
|- Index:     0
|- Line:      0
|- Cursor:    3
|- Column:    3
|- ---
|- Start:    Line: 0:0 - Index 0]
|- End:      Line: 0:0 - Index 0]
|- ---
|- This is word 2 of 4 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [<%#]
|- Current word:   [code:] <---
|- Next word:      [language=eps]
|- ---
|- State:     OPEN
|- Content:   []
|- Prefix:    [#]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is OPEN
- state condition: OPEN
STATE CHANGE: OPEN -> ELMT
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 3
After advancing : 9

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 3
After advancing : 9

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [code:]
-- }}} --

-- {{{ -Word 'language=eps' --
+-- {{{ -Column (9)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%# code: language=eps #%>
|  --------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (2) scanned in the input so far
|- Index:     0
|- Line:      0
|- Cursor:    9
|- Column:    9
|- ---
|- Start:    Line: 0:0 - Index 0]
|- End:      Line: 0:0 - Index 0]
|- ---
|- This is word 3 of 4 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [code:]
|- Current word:   [language=eps] <---
|- Next word:      [#%>]
|- ---
|- State:     ELMT
|- Content:   [ code:]
|- Prefix:    [#]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is ELMT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 9
After advancing : 22

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 9
After advancing : 22

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [language=eps]
-- }}} --

-- {{{ -Word '\#%>' --
+-- {{{ -Column (22)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%# code: language=eps #%>
|  ---------------------^
+------------------------------------------------------ }}} --
- Last word in line
-- {{{ info block --
| This is word (3) scanned in the input so far
|- Index:     0
|- Line:      0
|- Cursor:    22
|- Column:    22
|- ---
|- Start:    Line: 0:0 - Index 0]
|- End:      Line: 0:0 - Index 0]
|- ---
|- This is word 4 of 4 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [language=eps]
|- Current word:   [#%>] <---
|- Next word:      [
]
|- ---
|- State:     ELMT
|- Content:   [ code: language=eps]
|- Prefix:    [#]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: End Tag --
- Characters found before end tag
- Characters found is a Suffix
Check condition when state is ELMT
-- {{{ END TAG :: default --
lexeme is [ #%>]
- Advance the cursor and column by 4 to the end of the end tag

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 22
After advancing : 26

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 22
After advancing : 26

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
+-- {{{ -Column (26)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%# code: language=eps #%>
|  -------------------------^
+------------------------------------------------------ }}} --

--------------------------------------------------------------------------------
-- Begin Set-EndPosition
--------------------------------------------------------------------------------
Setting End Index => 26
Setting End Column => 26
Setting End Line => 0

--------------------------------------------------------------------------------
-- End Set-EndPosition
--------------------------------------------------------------------------------
**** Create Token ****

--------------------------------------------------------------------------------
-- Begin New-TemplateToken
Received : @{
    Indent = ''
    Suffix = '#'
    Content = ' code: language=eps'
    RemainingWhiteSpace = ''
    Index = 0
    Prefix = '#'
    Type = 'elmt'
    RemoveIndent = $false
    RemoveNewLine = $false
    End = @{
        Line = 0
        Index = 26
        Column = 26
    }
    Start = @{
        Line = 0
        Index = 0
        Column = 0
    }
}

Creating Token 0: TokenInfo :
 @{
    Suffix = '#'
    Type = 'CMNT'
    Prefix = '#'
    RemoveNewLine = $false
    PSTypeName = 'Stencil.TemplateToken.Comment'
    Length = 19
    Indent = ''
    Start = @{
        Line = 0
        Index = 0
        Column = 0
    }
    End = @{
        Line = 0
        Index = 26
        Column = 26
    }
    RemainingWhiteSpace = ''
    Index = 0
    Content = ' code: language=eps'
    RemoveIndent = $false
}

-- End New-TemplateToken
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Reset-TokenOption
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- End Reset-TokenOption
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using Count parameter
Current cursor is : 26
After advancing : 27

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using Count parameter
Current column is : 26
After advancing : 27

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Set-StartPosition
--------------------------------------------------------------------------------
Setting Start Index => 27
Setting Start Column => 27
Setting Start Line => 0

--------------------------------------------------------------------------------
-- End Set-StartPosition
--------------------------------------------------------------------------------
STATE CHANGE: ELMT -> CLOSE
-------------------------------------------------------------------------}}} --
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [#%>]
-- }}} --

- Add a newline to content
- Add Line Feed
END OF LINE
-- }}} --
increment linenumber
-- {{{ -Line------------------------------------------------------------------------------
No Carriage Return found
=================================== Line 002 ====================================
Current line: '<%-'
Split line into 1 words
-- {{{ -Word '<%-' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%-
|  ^
+------------------------------------------------------ }}} --
- Last word in line
-- {{{ info block --
| This is word (4) scanned in the input so far
|- Index:     1
|- Line:      2
|- Cursor:    27
|- Column:    0
|- ---
|- Start:    Line: 0:27 - Index 27]
|- End:      Line: 0:26 - Index 26]
|- ---
|- This is word 1 of 1 in this line
|- Is first word:  True
|- Is last word:  
|- Previous word:  [#%>]
|- Current word:   [<%-] <---
|- Next word:      [
]
|- ---
|- State:     CLOSE
|- Content:   [
]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: Start tag --
- Characters found after start tag
Characters found is a Prefix
Check condition when state is CLOSE
-- {{{ START TAG :: default --
There is content from the previous block.  Create token
- Set End position for the previous content before advancing
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%-
|  ^
+------------------------------------------------------ }}} --

--------------------------------------------------------------------------------
-- Begin Set-EndPosition
--------------------------------------------------------------------------------
Setting End Index => 27
Setting End Column => 0
Setting End Line => 2

--------------------------------------------------------------------------------
-- End Set-EndPosition
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin New-TemplateToken
Received : @{
    Indent = ''
    Suffix = ''
    Content = '
'
    RemainingWhiteSpace = ''
    Index = 1
    Prefix = ''
    Type = 'text'
    RemoveIndent = $false
    RemoveNewLine = $false
    End = @{
        Line = 2
        Index = 27
        Column = 0
    }
    Start = @{
        Line = 0
        Index = 27
        Column = 27
    }
}

Creating Token 1: TokenInfo :
 @{
    Suffix = ''
    Type = 'TEXT'
    Prefix = ''
    RemoveNewLine = $false
    PSTypeName = 'Stencil.TemplateToken.Text'
    Length = 1
    Indent = ''
    Start = @{
        Line = 0
        Index = 27
        Column = 27
    }
    End = @{
        Line = 2
        Index = 27
        Column = 0
    }
    RemainingWhiteSpace = ''
    Index = 1
    Content = '
'
    RemoveIndent = $false
}

-- End New-TemplateToken
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 27
After advancing : 31

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 0
After advancing : 4

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Reset-TokenOption
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- End Reset-TokenOption
--------------------------------------------------------------------------------
+-- {{{ -Column (4)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%-
|  ---^
+------------------------------------------------------ }}} --

--------------------------------------------------------------------------------
-- Begin Set-StartPosition
--------------------------------------------------------------------------------
Setting Start Index => 31
Setting Start Column => 4
Setting Start Line => 2

--------------------------------------------------------------------------------
-- End Set-StartPosition
--------------------------------------------------------------------------------
STATE CHANGE: CLOSE -> OPEN
- Store current word as prevWord
Finished scanning word [<%-]
-- }}} --

- Add a newline to content
- Add Line Feed
END OF LINE
-- }}} --
increment linenumber
-- {{{ -Line------------------------------------------------------------------------------
No Carriage Return found
=================================== Line 004 ====================================
Current line: '---'
Split line into 1 words
-- {{{ -Word '---' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  ---
|  ^
+------------------------------------------------------ }}} --
- Last word in line
-- {{{ info block --
| This is word (5) scanned in the input so far
|- Index:     2
|- Line:      4
|- Cursor:    31
|- Column:    0
|- ---
|- Start:    Line: 2:4 - Index 31]
|- End:      Line: 2:0 - Index 27]
|- ---
|- This is word 1 of 1 in this line
|- Is first word:  True
|- Is last word:  
|- Previous word:  [<%-]
|- Current word:   [---] <---
|- Next word:      [
]
|- ---
|- State:     OPEN
|- Content:   [
]
|- Prefix:    [-]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is OPEN
- state condition: OPEN
STATE CHANGE: OPEN -> ELMT
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 31
After advancing : 34

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 0
After advancing : 3

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [---]
-- }}} --

- Add a newline to content
- Add Line Feed
END OF LINE
-- }}} --
increment linenumber
-- {{{ -Line------------------------------------------------------------------------------
No Carriage Return found
=================================== Line 006 ====================================
Current line: 'title:\ test\ Template'
Split line into 3 words
-- {{{ -Word 'title:' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  title: test Template
|  ^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (6) scanned in the input so far
|- Index:     2
|- Line:      6
|- Cursor:    34
|- Column:    0
|- ---
|- Start:    Line: 2:4 - Index 31]
|- End:      Line: 2:0 - Index 27]
|- ---
|- This is word 1 of 3 in this line
|- Is first word:  True
|- Is last word:  
|- Previous word:  [---]
|- Current word:   [title:] <---
|- Next word:      [test]
|- ---
|- State:     ELMT
|- Content:   [
---
]
|- Prefix:    [-]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is ELMT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 34
After advancing : 40

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 0
After advancing : 6

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [title:]
-- }}} --

-- {{{ -Word 'test' --
+-- {{{ -Column (6)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  title: test Template
|  -----^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (7) scanned in the input so far
|- Index:     2
|- Line:      6
|- Cursor:    40
|- Column:    6
|- ---
|- Start:    Line: 2:4 - Index 31]
|- End:      Line: 2:0 - Index 27]
|- ---
|- This is word 2 of 3 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [title:]
|- Current word:   [test] <---
|- Next word:      [Template]
|- ---
|- State:     ELMT
|- Content:   [
---
title:]
|- Prefix:    [-]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is ELMT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 40
After advancing : 45

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 6
After advancing : 11

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [test]
-- }}} --

-- {{{ -Word 'Template' --
+-- {{{ -Column (11)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  title: test Template
|  ----------^
+------------------------------------------------------ }}} --
- Last word in line
-- {{{ info block --
| This is word (8) scanned in the input so far
|- Index:     2
|- Line:      6
|- Cursor:    45
|- Column:    11
|- ---
|- Start:    Line: 2:4 - Index 31]
|- End:      Line: 2:0 - Index 27]
|- ---
|- This is word 3 of 3 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [test]
|- Current word:   [Template] <---
|- Next word:      [
]
|- ---
|- State:     ELMT
|- Content:   [
---
title: test]
|- Prefix:    [-]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is ELMT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 45
After advancing : 54

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 11
After advancing : 20

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [Template]
-- }}} --

- Add a newline to content
- Add Line Feed
END OF LINE
-- }}} --
increment linenumber
-- {{{ -Line------------------------------------------------------------------------------
No Carriage Return found
=================================== Line 008 ====================================
Current line: 'tags:'
Split line into 1 words
-- {{{ -Word 'tags:' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  tags:
|  ^
+------------------------------------------------------ }}} --
- Last word in line
-- {{{ info block --
| This is word (9) scanned in the input so far
|- Index:     2
|- Line:      8
|- Cursor:    54
|- Column:    0
|- ---
|- Start:    Line: 2:4 - Index 31]
|- End:      Line: 2:0 - Index 27]
|- ---
|- This is word 1 of 1 in this line
|- Is first word:  True
|- Is last word:  
|- Previous word:  [Template]
|- Current word:   [tags:] <---
|- Next word:      [
]
|- ---
|- State:     ELMT
|- Content:   [
---
title: test Template
]
|- Prefix:    [-]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is ELMT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 54
After advancing : 59

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 0
After advancing : 5

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [tags:]
-- }}} --

- Add a newline to content
- Add Line Feed
END OF LINE
-- }}} --
increment linenumber
-- {{{ -Line------------------------------------------------------------------------------
No Carriage Return found
=================================== Line 010 ====================================
Current line: '\ \ -\ test'
Split line into 4 words
-- {{{ -Word '' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|    - test
|  ^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (10) scanned in the input so far
|- Index:     2
|- Line:      10
|- Cursor:    59
|- Column:    0
|- ---
|- Start:    Line: 2:4 - Index 31]
|- End:      Line: 2:0 - Index 27]
|- ---
|- This is word 1 of 4 in this line
|- Is first word:  True
|- Is last word:  
|- Previous word:  [tags:]
|- Current word:   [] <---
|- Next word:      []
|- ---
|- State:     ELMT
|- Content:   [
---
title: test Template
tags:
]
|- Prefix:    [-]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: whitespace --
-- }}} --
- Store current word as prevWord
Finished scanning word []
-- }}} --

-- {{{ -Word '' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|    - test
|  ^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (11) scanned in the input so far
|- Index:     2
|- Line:      10
|- Cursor:    59
|- Column:    0
|- ---
|- Start:    Line: 2:4 - Index 31]
|- End:      Line: 2:0 - Index 27]
|- ---
|- This is word 2 of 4 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  []
|- Current word:   [] <---
|- Next word:      [-]
|- ---
|- State:     ELMT
|- Content:   [
---
title: test Template
tags:
 ]
|- Prefix:    [-]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: whitespace --
-- }}} --
- Store current word as prevWord
Finished scanning word []
-- }}} --

-- {{{ -Word '-' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|    - test
|  ^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (12) scanned in the input so far
|- Index:     2
|- Line:      10
|- Cursor:    59
|- Column:    0
|- ---
|- Start:    Line: 2:4 - Index 31]
|- End:      Line: 2:0 - Index 27]
|- ---
|- This is word 3 of 4 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  []
|- Current word:   [-] <---
|- Next word:      [test]
|- ---
|- State:     ELMT
|- Content:   [
---
title: test Template
tags:
  ]
|- Prefix:    [-]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is ELMT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 59
After advancing : 61

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 0
After advancing : 2

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [-]
-- }}} --

-- {{{ -Word 'test' --
+-- {{{ -Column (2)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|    - test
|  -^
+------------------------------------------------------ }}} --
- Last word in line
-- {{{ info block --
| This is word (13) scanned in the input so far
|- Index:     2
|- Line:      10
|- Cursor:    61
|- Column:    2
|- ---
|- Start:    Line: 2:4 - Index 31]
|- End:      Line: 2:0 - Index 27]
|- ---
|- This is word 4 of 4 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [-]
|- Current word:   [test] <---
|- Next word:      [
]
|- ---
|- State:     ELMT
|- Content:   [
---
title: test Template
tags:
   -]
|- Prefix:    [-]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is ELMT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 61
After advancing : 66

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 2
After advancing : 7

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [test]
-- }}} --

- Add a newline to content
- Add Line Feed
END OF LINE
-- }}} --
increment linenumber
-- {{{ -Line------------------------------------------------------------------------------
No Carriage Return found
=================================== Line 012 ====================================
Current line: '---'
Split line into 1 words
-- {{{ -Word '---' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  ---
|  ^
+------------------------------------------------------ }}} --
- Last word in line
-- {{{ info block --
| This is word (14) scanned in the input so far
|- Index:     2
|- Line:      12
|- Cursor:    66
|- Column:    0
|- ---
|- Start:    Line: 2:4 - Index 31]
|- End:      Line: 2:0 - Index 27]
|- ---
|- This is word 1 of 1 in this line
|- Is first word:  True
|- Is last word:  
|- Previous word:  [test]
|- Current word:   [---] <---
|- Next word:      [
]
|- ---
|- State:     ELMT
|- Content:   [
---
title: test Template
tags:
   - test
]
|- Prefix:    [-]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is ELMT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 66
After advancing : 69

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 0
After advancing : 3

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [---]
-- }}} --

- Add a newline to content
- Add Line Feed
END OF LINE
-- }}} --
increment linenumber
-- {{{ -Line------------------------------------------------------------------------------
No Carriage Return found
=================================== Line 014 ====================================
Current line: '%>'
Split line into 1 words
-- {{{ -Word '%>' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  %>
|  ^
+------------------------------------------------------ }}} --
- Last word in line
-- {{{ info block --
| This is word (15) scanned in the input so far
|- Index:     2
|- Line:      14
|- Cursor:    69
|- Column:    0
|- ---
|- Start:    Line: 2:4 - Index 31]
|- End:      Line: 2:0 - Index 27]
|- ---
|- This is word 1 of 1 in this line
|- Is first word:  True
|- Is last word:  
|- Previous word:  [---]
|- Current word:   [%>] <---
|- Next word:      [
]
|- ---
|- State:     ELMT
|- Content:   [
---
title: test Template
tags:
   - test
---
]
|- Prefix:    [-]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: End Tag --
-- No characters found before end tag
Check condition when state is ELMT
-- {{{ END TAG :: default --
lexeme is [%>]
- Advance the cursor and column by 2 to the end of the end tag

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 69
After advancing : 71

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 0
After advancing : 2

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
+-- {{{ -Column (2)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  %>
|  -^
+------------------------------------------------------ }}} --

--------------------------------------------------------------------------------
-- Begin Set-EndPosition
--------------------------------------------------------------------------------
Setting End Index => 71
Setting End Column => 2
Setting End Line => 14

--------------------------------------------------------------------------------
-- End Set-EndPosition
--------------------------------------------------------------------------------
**** Create Token ****

--------------------------------------------------------------------------------
-- Begin New-TemplateToken
Received : @{
    Indent = ''
    Suffix = ''
    Content = '
---
title: test Template
tags:
   - test
---
'
    RemainingWhiteSpace = ''
    Index = 2
    Prefix = '-'
    Type = 'elmt'
    RemoveIndent = $false
    RemoveNewLine = $false
    End = @{
        Line = 14
        Index = 71
        Column = 2
    }
    Start = @{
        Line = 2
        Index = 31
        Column = 4
    }
}

Creating Token 2: TokenInfo :
 @{
    Suffix = ''
    Type = 'FMTR'
    Prefix = '-'
    RemoveNewLine = $false
    PSTypeName = 'Stencil.TemplateToken.FrontMatter'
    Length = 46
    Indent = ''
    Start = @{
        Line = 2
        Index = 31
        Column = 4
    }
    End = @{
        Line = 14
        Index = 71
        Column = 2
    }
    RemainingWhiteSpace = ''
    Index = 2
    Content = '
---
title: test Template
tags:
   - test
---
'
    RemoveIndent = $true
}

-- End New-TemplateToken
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Reset-TokenOption
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- End Reset-TokenOption
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using Count parameter
Current cursor is : 71
After advancing : 72

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using Count parameter
Current column is : 2
After advancing : 3

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Set-StartPosition
--------------------------------------------------------------------------------
Setting Start Index => 72
Setting Start Column => 3
Setting Start Line => 14

--------------------------------------------------------------------------------
-- End Set-StartPosition
--------------------------------------------------------------------------------
STATE CHANGE: ELMT -> CLOSE
-------------------------------------------------------------------------}}} --
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [%>]
-- }}} --

- Add a newline to content
- Add Line Feed
END OF LINE
-- }}} --
increment linenumber
-- {{{ -Line------------------------------------------------------------------------------
No Carriage Return found
=================================== Line 016 ====================================
Current line: ''
Split line into 1 words
-- {{{ -Word '' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  
|  ^
+------------------------------------------------------ }}} --
- Last word in line
-- {{{ info block --
| This is word (16) scanned in the input so far
|- Index:     3
|- Line:      16
|- Cursor:    72
|- Column:    0
|- ---
|- Start:    Line: 14:3 - Index 72]
|- End:      Line: 14:2 - Index 71]
|- ---
|- This is word 1 of 1 in this line
|- Is first word:  True
|- Is last word:  
|- Previous word:  [%>]
|- Current word:   [] <---
|- Next word:      [
]
|- ---
|- State:     CLOSE
|- Content:   [
]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: whitespace --
-- }}} --
- Store current word as prevWord
Finished scanning word []
-- }}} --

- Add a newline to content
- Add Line Feed
END OF LINE
-- }}} --
increment linenumber
-- {{{ -Line------------------------------------------------------------------------------
No Carriage Return found
=================================== Line 018 ====================================
Current line: '<%---\ What\ should\ this\ be\?\ ---%>'
Split line into 6 words
-- {{{ -Word '<%---' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%--- What should this be? ---%>
|  ^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (17) scanned in the input so far
|- Index:     3
|- Line:      18
|- Cursor:    72
|- Column:    0
|- ---
|- Start:    Line: 14:3 - Index 72]
|- End:      Line: 14:2 - Index 71]
|- ---
|- This is word 1 of 6 in this line
|- Is first word:  True
|- Is last word:  
|- Previous word:  []
|- Current word:   [<%---] <---
|- Next word:      [What]
|- ---
|- State:     CLOSE
|- Content:   [
 
]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: Start tag --
- Characters found after start tag
Characters found is a Prefix
Check condition when state is CLOSE
-- {{{ START TAG :: default --
There is content from the previous block.  Create token
- Set End position for the previous content before advancing
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%--- What should this be? ---%>
|  ^
+------------------------------------------------------ }}} --

--------------------------------------------------------------------------------
-- Begin Set-EndPosition
--------------------------------------------------------------------------------
Setting End Index => 72
Setting End Column => 0
Setting End Line => 18

--------------------------------------------------------------------------------
-- End Set-EndPosition
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin New-TemplateToken
Received : @{
    Indent = ''
    Suffix = ''
    Content = '
 
'
    RemainingWhiteSpace = ''
    Index = 3
    Prefix = ''
    Type = 'text'
    RemoveIndent = $false
    RemoveNewLine = $false
    End = @{
        Line = 18
        Index = 72
        Column = 0
    }
    Start = @{
        Line = 14
        Index = 72
        Column = 3
    }
}

Creating Token 3: TokenInfo :
 @{
    Suffix = ''
    Type = 'TEXT'
    Prefix = ''
    RemoveNewLine = $false
    PSTypeName = 'Stencil.TemplateToken.Text'
    Length = 3
    Indent = ''
    Start = @{
        Line = 14
        Index = 72
        Column = 3
    }
    End = @{
        Line = 18
        Index = 72
        Column = 0
    }
    RemainingWhiteSpace = ''
    Index = 3
    Content = '
 
'
    RemoveIndent = $false
}

-- End New-TemplateToken
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 72
After advancing : 74

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 0
After advancing : 2

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Reset-TokenOption
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- End Reset-TokenOption
--------------------------------------------------------------------------------
+-- {{{ -Column (2)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%--- What should this be? ---%>
|  -^
+------------------------------------------------------ }}} --

--------------------------------------------------------------------------------
-- Begin Set-StartPosition
--------------------------------------------------------------------------------
Setting Start Index => 74
Setting Start Column => 2
Setting Start Line => 18

--------------------------------------------------------------------------------
-- End Set-StartPosition
--------------------------------------------------------------------------------
STATE CHANGE: CLOSE -> OPEN
- Store current word as prevWord
Finished scanning word [<%---]
-- }}} --

-- {{{ -Word 'What' --
+-- {{{ -Column (2)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%--- What should this be? ---%>
|  -^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (18) scanned in the input so far
|- Index:     4
|- Line:      18
|- Cursor:    74
|- Column:    2
|- ---
|- Start:    Line: 18:2 - Index 74]
|- End:      Line: 18:0 - Index 72]
|- ---
|- This is word 2 of 6 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [<%---]
|- Current word:   [What] <---
|- Next word:      [should]
|- ---
|- State:     OPEN
|- Content:   []
|- Prefix:    [---]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is OPEN
- state condition: OPEN
STATE CHANGE: OPEN -> ELMT
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 74
After advancing : 79

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 2
After advancing : 7

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [What]
-- }}} --

-- {{{ -Word 'should' --
+-- {{{ -Column (7)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%--- What should this be? ---%>
|  ------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (19) scanned in the input so far
|- Index:     4
|- Line:      18
|- Cursor:    79
|- Column:    7
|- ---
|- Start:    Line: 18:2 - Index 74]
|- End:      Line: 18:0 - Index 72]
|- ---
|- This is word 3 of 6 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [What]
|- Current word:   [should] <---
|- Next word:      [this]
|- ---
|- State:     ELMT
|- Content:   [ What]
|- Prefix:    [---]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is ELMT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 79
After advancing : 86

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 7
After advancing : 14

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [should]
-- }}} --

-- {{{ -Word 'this' --
+-- {{{ -Column (14)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%--- What should this be? ---%>
|  -------------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (20) scanned in the input so far
|- Index:     4
|- Line:      18
|- Cursor:    86
|- Column:    14
|- ---
|- Start:    Line: 18:2 - Index 74]
|- End:      Line: 18:0 - Index 72]
|- ---
|- This is word 4 of 6 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [should]
|- Current word:   [this] <---
|- Next word:      [be?]
|- ---
|- State:     ELMT
|- Content:   [ What should]
|- Prefix:    [---]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is ELMT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 86
After advancing : 91

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 14
After advancing : 19

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [this]
-- }}} --

-- {{{ -Word 'be\?' --
+-- {{{ -Column (19)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%--- What should this be? ---%>
|  ------------------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (21) scanned in the input so far
|- Index:     4
|- Line:      18
|- Cursor:    91
|- Column:    19
|- ---
|- Start:    Line: 18:2 - Index 74]
|- End:      Line: 18:0 - Index 72]
|- ---
|- This is word 5 of 6 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [this]
|- Current word:   [be?] <---
|- Next word:      [---%>]
|- ---
|- State:     ELMT
|- Content:   [ What should this]
|- Prefix:    [---]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is ELMT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 91
After advancing : 95

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 19
After advancing : 23

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [be?]
-- }}} --

-- {{{ -Word '---%>' --
+-- {{{ -Column (23)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%--- What should this be? ---%>
|  ----------------------^
+------------------------------------------------------ }}} --
- Last word in line
-- {{{ info block --
| This is word (22) scanned in the input so far
|- Index:     4
|- Line:      18
|- Cursor:    95
|- Column:    23
|- ---
|- Start:    Line: 18:2 - Index 74]
|- End:      Line: 18:0 - Index 72]
|- ---
|- This is word 6 of 6 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [be?]
|- Current word:   [---%>] <---
|- Next word:      [
]
|- ---
|- State:     ELMT
|- Content:   [ What should this be?]
|- Prefix:    [---]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: End Tag --
- Characters found before end tag
- Characters found is a Suffix
Check condition when state is ELMT
-- {{{ END TAG :: default --
lexeme is [ ---%>]
- Advance the cursor and column by 6 to the end of the end tag

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 95
After advancing : 101

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 23
After advancing : 29

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
+-- {{{ -Column (29)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%--- What should this be? ---%>
|  ----------------------------^
+------------------------------------------------------ }}} --

--------------------------------------------------------------------------------
-- Begin Set-EndPosition
--------------------------------------------------------------------------------
Setting End Index => 101
Setting End Column => 29
Setting End Line => 18

--------------------------------------------------------------------------------
-- End Set-EndPosition
--------------------------------------------------------------------------------
**** Create Token ****

--------------------------------------------------------------------------------
-- Begin New-TemplateToken
Received : @{
    Indent = ''
    Suffix = '---'
    Content = ' What should this be?'
    RemainingWhiteSpace = ''
    Index = 4
    Prefix = '---'
    Type = 'elmt'
    RemoveIndent = $false
    RemoveNewLine = $false
    End = @{
        Line = 18
        Index = 101
        Column = 29
    }
    Start = @{
        Line = 18
        Index = 74
        Column = 2
    }
}

Creating Token 4: TokenInfo :
 @{
    Suffix = '---'
    Type = 'ELMT'
    Prefix = '---'
    RemoveNewLine = $false
    PSTypeName = 'Stencil.TemplateToken.Elmt'
    Length = 21
    Indent = ''
    Start = @{
        Line = 18
        Index = 74
        Column = 2
    }
    End = @{
        Line = 18
        Index = 101
        Column = 29
    }
    RemainingWhiteSpace = ''
    Index = 4
    Content = ' What should this be?'
    RemoveIndent = $false
}

-- End New-TemplateToken
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Reset-TokenOption
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- End Reset-TokenOption
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using Count parameter
Current cursor is : 101
After advancing : 102

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using Count parameter
Current column is : 29
After advancing : 30

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Set-StartPosition
--------------------------------------------------------------------------------
Setting Start Index => 102
Setting Start Column => 30
Setting Start Line => 18

--------------------------------------------------------------------------------
-- End Set-StartPosition
--------------------------------------------------------------------------------
STATE CHANGE: ELMT -> CLOSE
-------------------------------------------------------------------------}}} --
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [---%>]
-- }}} --

- Add a newline to content
- Add Line Feed
END OF LINE
-- }}} --
increment linenumber
-- {{{ -Line------------------------------------------------------------------------------
No Carriage Return found
=================================== Line 020 ====================================
Current line: 'A\ test\ template'
Split line into 3 words
-- {{{ -Word 'A' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  A test template
|  ^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (23) scanned in the input so far
|- Index:     5
|- Line:      20
|- Cursor:    102
|- Column:    0
|- ---
|- Start:    Line: 18:30 - Index 102]
|- End:      Line: 18:29 - Index 101]
|- ---
|- This is word 1 of 3 in this line
|- Is first word:  True
|- Is last word:  
|- Previous word:  [---%>]
|- Current word:   [A] <---
|- Next word:      [test]
|- ---
|- State:     CLOSE
|- Content:   [
]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is CLOSE
- state condition: CLOSE
STATE CHANGE: CLOSE -> TEXT

--------------------------------------------------------------------------------
-- Begin Set-StartPosition
--------------------------------------------------------------------------------
Setting Start Index => 102
Setting Start Column => 0
Setting Start Line => 20

--------------------------------------------------------------------------------
-- End Set-StartPosition
--------------------------------------------------------------------------------
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 102
After advancing : 103

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 0
After advancing : 1

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [A]
-- }}} --

-- {{{ -Word 'test' --
+-- {{{ -Column (1)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  A test template
|  ^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (24) scanned in the input so far
|- Index:     5
|- Line:      20
|- Cursor:    103
|- Column:    1
|- ---
|- Start:    Line: 20:0 - Index 102]
|- End:      Line: 18:29 - Index 101]
|- ---
|- This is word 2 of 3 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [A]
|- Current word:   [test] <---
|- Next word:      [template]
|- ---
|- State:     TEXT
|- Content:   [
A]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is TEXT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 103
After advancing : 108

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 1
After advancing : 6

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [test]
-- }}} --

-- {{{ -Word 'template' --
+-- {{{ -Column (6)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  A test template
|  -----^
+------------------------------------------------------ }}} --
- Last word in line
-- {{{ info block --
| This is word (25) scanned in the input so far
|- Index:     5
|- Line:      20
|- Cursor:    108
|- Column:    6
|- ---
|- Start:    Line: 20:0 - Index 102]
|- End:      Line: 18:29 - Index 101]
|- ---
|- This is word 3 of 3 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [test]
|- Current word:   [template] <---
|- Next word:      [
]
|- ---
|- State:     TEXT
|- Content:   [
A test]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is TEXT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 108
After advancing : 117

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 6
After advancing : 15

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [template]
-- }}} --

- Add a newline to content
- Add Line Feed
END OF LINE
-- }}} --
increment linenumber
-- {{{ -Line------------------------------------------------------------------------------
No Carriage Return found
=================================== Line 022 ====================================
Current line: ''
Split line into 1 words
-- {{{ -Word '' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  
|  ^
+------------------------------------------------------ }}} --
- Last word in line
-- {{{ info block --
| This is word (26) scanned in the input so far
|- Index:     5
|- Line:      22
|- Cursor:    117
|- Column:    0
|- ---
|- Start:    Line: 20:0 - Index 102]
|- End:      Line: 18:29 - Index 101]
|- ---
|- This is word 1 of 1 in this line
|- Is first word:  True
|- Is last word:  
|- Previous word:  [template]
|- Current word:   [] <---
|- Next word:      [
]
|- ---
|- State:     TEXT
|- Content:   [
A test template
]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: whitespace --
-- }}} --
- Store current word as prevWord
Finished scanning word []
-- }}} --

- Add a newline to content
- Add Line Feed
END OF LINE
-- }}} --
increment linenumber
-- {{{ -Line------------------------------------------------------------------------------
No Carriage Return found
=================================== Line 024 ====================================
Current line: 'this\ should\ output\ the\ start\ marker\ <%%'
Split line into 7 words
-- {{{ -Word 'this' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  this should output the start marker <%%
|  ^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (27) scanned in the input so far
|- Index:     5
|- Line:      24
|- Cursor:    117
|- Column:    0
|- ---
|- Start:    Line: 20:0 - Index 102]
|- End:      Line: 18:29 - Index 101]
|- ---
|- This is word 1 of 7 in this line
|- Is first word:  True
|- Is last word:  
|- Previous word:  []
|- Current word:   [this] <---
|- Next word:      [should]
|- ---
|- State:     TEXT
|- Content:   [
A test template
 
]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is TEXT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 117
After advancing : 121

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 0
After advancing : 4

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [this]
-- }}} --

-- {{{ -Word 'should' --
+-- {{{ -Column (4)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  this should output the start marker <%%
|  ---^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (28) scanned in the input so far
|- Index:     5
|- Line:      24
|- Cursor:    121
|- Column:    4
|- ---
|- Start:    Line: 20:0 - Index 102]
|- End:      Line: 18:29 - Index 101]
|- ---
|- This is word 2 of 7 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [this]
|- Current word:   [should] <---
|- Next word:      [output]
|- ---
|- State:     TEXT
|- Content:   [
A test template
 
this]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is TEXT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 121
After advancing : 128

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 4
After advancing : 11

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [should]
-- }}} --

-- {{{ -Word 'output' --
+-- {{{ -Column (11)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  this should output the start marker <%%
|  ----------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (29) scanned in the input so far
|- Index:     5
|- Line:      24
|- Cursor:    128
|- Column:    11
|- ---
|- Start:    Line: 20:0 - Index 102]
|- End:      Line: 18:29 - Index 101]
|- ---
|- This is word 3 of 7 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [should]
|- Current word:   [output] <---
|- Next word:      [the]
|- ---
|- State:     TEXT
|- Content:   [
A test template
 
this should]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is TEXT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 128
After advancing : 135

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 11
After advancing : 18

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [output]
-- }}} --

-- {{{ -Word 'the' --
+-- {{{ -Column (18)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  this should output the start marker <%%
|  -----------------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (30) scanned in the input so far
|- Index:     5
|- Line:      24
|- Cursor:    135
|- Column:    18
|- ---
|- Start:    Line: 20:0 - Index 102]
|- End:      Line: 18:29 - Index 101]
|- ---
|- This is word 4 of 7 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [output]
|- Current word:   [the] <---
|- Next word:      [start]
|- ---
|- State:     TEXT
|- Content:   [
A test template
 
this should output]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is TEXT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 135
After advancing : 139

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 18
After advancing : 22

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [the]
-- }}} --

-- {{{ -Word 'start' --
+-- {{{ -Column (22)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  this should output the start marker <%%
|  ---------------------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (31) scanned in the input so far
|- Index:     5
|- Line:      24
|- Cursor:    139
|- Column:    22
|- ---
|- Start:    Line: 20:0 - Index 102]
|- End:      Line: 18:29 - Index 101]
|- ---
|- This is word 5 of 7 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [the]
|- Current word:   [start] <---
|- Next word:      [marker]
|- ---
|- State:     TEXT
|- Content:   [
A test template
 
this should output the]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is TEXT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 139
After advancing : 145

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 22
After advancing : 28

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [start]
-- }}} --

-- {{{ -Word 'marker' --
+-- {{{ -Column (28)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  this should output the start marker <%%
|  ---------------------------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (32) scanned in the input so far
|- Index:     5
|- Line:      24
|- Cursor:    145
|- Column:    28
|- ---
|- Start:    Line: 20:0 - Index 102]
|- End:      Line: 18:29 - Index 101]
|- ---
|- This is word 6 of 7 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [start]
|- Current word:   [marker] <---
|- Next word:      [<%%]
|- ---
|- State:     TEXT
|- Content:   [
A test template
 
this should output the start]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is TEXT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 145
After advancing : 152

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 28
After advancing : 35

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [marker]
-- }}} --

-- {{{ -Word '<%%' --
+-- {{{ -Column (35)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  this should output the start marker <%%
|  ----------------------------------^
+------------------------------------------------------ }}} --
- Last word in line
-- {{{ info block --
| This is word (33) scanned in the input so far
|- Index:     5
|- Line:      24
|- Cursor:    152
|- Column:    35
|- ---
|- Start:    Line: 20:0 - Index 102]
|- End:      Line: 18:29 - Index 101]
|- ---
|- This is word 7 of 7 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [marker]
|- Current word:   [<%%] <---
|- Next word:      [
]
|- ---
|- State:     TEXT
|- Content:   [
A test template
 
this should output the start marker]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: Start tag --
- Characters found after start tag
** ESCAPED START - Add start tag to content
  - Adding  <%% to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 152
After advancing : 156

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 35
After advancing : 39

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Add a newline to content
- Add Line Feed
END OF LINE
-- }}} --
increment linenumber
-- {{{ -Line------------------------------------------------------------------------------
No Carriage Return found
=================================== Line 026 ====================================
Current line: ''
Split line into 1 words
-- {{{ -Word '' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  
|  ^
+------------------------------------------------------ }}} --
- Last word in line
-- {{{ info block --
| This is word (34) scanned in the input so far
|- Index:     5
|- Line:      26
|- Cursor:    156
|- Column:    0
|- ---
|- Start:    Line: 20:0 - Index 102]
|- End:      Line: 18:29 - Index 101]
|- ---
|- This is word 1 of 1 in this line
|- Is first word:  True
|- Is last word:  
|- Previous word:  [marker]
|- Current word:   [] <---
|- Next word:      [
]
|- ---
|- State:     TEXT
|- Content:   [
A test template
 
this should output the start marker <%%
]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: whitespace --
-- }}} --
- Store current word as prevWord
Finished scanning word []
-- }}} --

- Add a newline to content
- Add Line Feed
END OF LINE
-- }}} --
increment linenumber
-- {{{ -Line------------------------------------------------------------------------------
No Carriage Return found
=================================== Line 028 ====================================
Current line: 'this\ should\ output\ the\ end\ marker\ %%>'
Split line into 7 words
-- {{{ -Word 'this' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  this should output the end marker %%>
|  ^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (35) scanned in the input so far
|- Index:     5
|- Line:      28
|- Cursor:    156
|- Column:    0
|- ---
|- Start:    Line: 20:0 - Index 102]
|- End:      Line: 18:29 - Index 101]
|- ---
|- This is word 1 of 7 in this line
|- Is first word:  True
|- Is last word:  
|- Previous word:  []
|- Current word:   [this] <---
|- Next word:      [should]
|- ---
|- State:     TEXT
|- Content:   [
A test template
 
this should output the start marker <%%
 
]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is TEXT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 156
After advancing : 160

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 0
After advancing : 4

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [this]
-- }}} --

-- {{{ -Word 'should' --
+-- {{{ -Column (4)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  this should output the end marker %%>
|  ---^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (36) scanned in the input so far
|- Index:     5
|- Line:      28
|- Cursor:    160
|- Column:    4
|- ---
|- Start:    Line: 20:0 - Index 102]
|- End:      Line: 18:29 - Index 101]
|- ---
|- This is word 2 of 7 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [this]
|- Current word:   [should] <---
|- Next word:      [output]
|- ---
|- State:     TEXT
|- Content:   [
A test template
 
this should output the start marker <%%
 
this]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is TEXT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 160
After advancing : 167

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 4
After advancing : 11

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [should]
-- }}} --

-- {{{ -Word 'output' --
+-- {{{ -Column (11)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  this should output the end marker %%>
|  ----------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (37) scanned in the input so far
|- Index:     5
|- Line:      28
|- Cursor:    167
|- Column:    11
|- ---
|- Start:    Line: 20:0 - Index 102]
|- End:      Line: 18:29 - Index 101]
|- ---
|- This is word 3 of 7 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [should]
|- Current word:   [output] <---
|- Next word:      [the]
|- ---
|- State:     TEXT
|- Content:   [
A test template
 
this should output the start marker <%%
 
this should]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is TEXT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 167
After advancing : 174

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 11
After advancing : 18

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [output]
-- }}} --

-- {{{ -Word 'the' --
+-- {{{ -Column (18)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  this should output the end marker %%>
|  -----------------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (38) scanned in the input so far
|- Index:     5
|- Line:      28
|- Cursor:    174
|- Column:    18
|- ---
|- Start:    Line: 20:0 - Index 102]
|- End:      Line: 18:29 - Index 101]
|- ---
|- This is word 4 of 7 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [output]
|- Current word:   [the] <---
|- Next word:      [end]
|- ---
|- State:     TEXT
|- Content:   [
A test template
 
this should output the start marker <%%
 
this should output]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is TEXT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 174
After advancing : 178

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 18
After advancing : 22

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [the]
-- }}} --

-- {{{ -Word 'end' --
+-- {{{ -Column (22)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  this should output the end marker %%>
|  ---------------------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (39) scanned in the input so far
|- Index:     5
|- Line:      28
|- Cursor:    178
|- Column:    22
|- ---
|- Start:    Line: 20:0 - Index 102]
|- End:      Line: 18:29 - Index 101]
|- ---
|- This is word 5 of 7 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [the]
|- Current word:   [end] <---
|- Next word:      [marker]
|- ---
|- State:     TEXT
|- Content:   [
A test template
 
this should output the start marker <%%
 
this should output the]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is TEXT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 178
After advancing : 182

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 22
After advancing : 26

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [end]
-- }}} --

-- {{{ -Word 'marker' --
+-- {{{ -Column (26)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  this should output the end marker %%>
|  -------------------------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (40) scanned in the input so far
|- Index:     5
|- Line:      28
|- Cursor:    182
|- Column:    26
|- ---
|- Start:    Line: 20:0 - Index 102]
|- End:      Line: 18:29 - Index 101]
|- ---
|- This is word 6 of 7 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [end]
|- Current word:   [marker] <---
|- Next word:      [%%>]
|- ---
|- State:     TEXT
|- Content:   [
A test template
 
this should output the start marker <%%
 
this should output the end]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is TEXT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 182
After advancing : 189

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 26
After advancing : 33

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [marker]
-- }}} --

-- {{{ -Word '%%>' --
+-- {{{ -Column (33)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  this should output the end marker %%>
|  --------------------------------^
+------------------------------------------------------ }}} --
- Last word in line
-- {{{ info block --
| This is word (41) scanned in the input so far
|- Index:     5
|- Line:      28
|- Cursor:    189
|- Column:    33
|- ---
|- Start:    Line: 20:0 - Index 102]
|- End:      Line: 18:29 - Index 101]
|- ---
|- This is word 7 of 7 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [marker]
|- Current word:   [%%>] <---
|- Next word:      [
]
|- ---
|- State:     TEXT
|- Content:   [
A test template
 
this should output the start marker <%%
 
this should output the end marker]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: End Tag --
- Characters found before end tag
ESCAPED END - Add end tag to content
- Adding  %> to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 189
After advancing : 192

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 33
After advancing : 36

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
Check condition when state is TEXT
** Error Found end tag without start tag
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [%%>]
-- }}} --

- Add a newline to content
- Add Line Feed
END OF LINE
-- }}} --
increment linenumber
-- {{{ -Line------------------------------------------------------------------------------
No Carriage Return found
=================================== Line 030 ====================================
Current line: ''
Split line into 1 words
-- {{{ -Word '' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  
|  ^
+------------------------------------------------------ }}} --
- Last word in line
-- {{{ info block --
| This is word (42) scanned in the input so far
|- Index:     5
|- Line:      30
|- Cursor:    192
|- Column:    0
|- ---
|- Start:    Line: 20:0 - Index 102]
|- End:      Line: 18:29 - Index 101]
|- ---
|- This is word 1 of 1 in this line
|- Is first word:  True
|- Is last word:  
|- Previous word:  [%%>]
|- Current word:   [] <---
|- Next word:      [
]
|- ---
|- State:     TEXT
|- Content:   [
A test template
 
this should output the start marker <%%
 
this should output the end marker %>
]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: whitespace --
-- }}} --
- Store current word as prevWord
Finished scanning word []
-- }}} --

- Add a newline to content
- Add Line Feed
END OF LINE
-- }}} --
increment linenumber
-- {{{ -Line------------------------------------------------------------------------------
No Carriage Return found
=================================== Line 032 ====================================
Current line: '<%\#\ this\ should\ be\ a\ comment\ \#%>'
Split line into 7 words
-- {{{ -Word '<%\#' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%# this should be a comment #%>
|  ^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (43) scanned in the input so far
|- Index:     5
|- Line:      32
|- Cursor:    192
|- Column:    0
|- ---
|- Start:    Line: 20:0 - Index 102]
|- End:      Line: 18:29 - Index 101]
|- ---
|- This is word 1 of 7 in this line
|- Is first word:  True
|- Is last word:  
|- Previous word:  []
|- Current word:   [<%#] <---
|- Next word:      [this]
|- ---
|- State:     TEXT
|- Content:   [
A test template
 
this should output the start marker <%%
 
this should output the end marker %>
 
]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: Start tag --
- Characters found after start tag
Characters found is a Prefix
Check condition when state is TEXT
-- {{{ START TAG :: default --
There is content from the previous block.  Create token
- Set End position for the previous content before advancing
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%# this should be a comment #%>
|  ^
+------------------------------------------------------ }}} --

--------------------------------------------------------------------------------
-- Begin Set-EndPosition
--------------------------------------------------------------------------------
Setting End Index => 192
Setting End Column => 0
Setting End Line => 32

--------------------------------------------------------------------------------
-- End Set-EndPosition
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin New-TemplateToken
Received : @{
    Indent = ''
    Suffix = ''
    Content = '
A test template
 
this should output the start marker <%%
 
this should output the end marker %>
 
'
    RemainingWhiteSpace = ''
    Index = 5
    Prefix = ''
    Type = 'text'
    RemoveIndent = $false
    RemoveNewLine = $false
    End = @{
        Line = 32
        Index = 192
        Column = 0
    }
    Start = @{
        Line = 20
        Index = 102
        Column = 0
    }
}

Creating Token 5: TokenInfo :
 @{
    Suffix = ''
    Type = 'TEXT'
    Prefix = ''
    RemoveNewLine = $false
    PSTypeName = 'Stencil.TemplateToken.Text'
    Length = 100
    Indent = ''
    Start = @{
        Line = 20
        Index = 102
        Column = 0
    }
    End = @{
        Line = 32
        Index = 192
        Column = 0
    }
    RemainingWhiteSpace = ''
    Index = 5
    Content = '
A test template
 
this should output the start marker <%%
 
this should output the end marker %>
 
'
    RemoveIndent = $false
}

-- End New-TemplateToken
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 192
After advancing : 195

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 0
After advancing : 3

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Reset-TokenOption
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- End Reset-TokenOption
--------------------------------------------------------------------------------
+-- {{{ -Column (3)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%# this should be a comment #%>
|  --^
+------------------------------------------------------ }}} --

--------------------------------------------------------------------------------
-- Begin Set-StartPosition
--------------------------------------------------------------------------------
Setting Start Index => 195
Setting Start Column => 3
Setting Start Line => 32

--------------------------------------------------------------------------------
-- End Set-StartPosition
--------------------------------------------------------------------------------
STATE CHANGE: TEXT -> OPEN
- Store current word as prevWord
Finished scanning word [<%#]
-- }}} --

-- {{{ -Word 'this' --
+-- {{{ -Column (3)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%# this should be a comment #%>
|  --^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (44) scanned in the input so far
|- Index:     6
|- Line:      32
|- Cursor:    195
|- Column:    3
|- ---
|- Start:    Line: 32:3 - Index 195]
|- End:      Line: 32:0 - Index 192]
|- ---
|- This is word 2 of 7 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [<%#]
|- Current word:   [this] <---
|- Next word:      [should]
|- ---
|- State:     OPEN
|- Content:   []
|- Prefix:    [#]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is OPEN
- state condition: OPEN
STATE CHANGE: OPEN -> ELMT
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 195
After advancing : 200

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 3
After advancing : 8

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [this]
-- }}} --

-- {{{ -Word 'should' --
+-- {{{ -Column (8)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%# this should be a comment #%>
|  -------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (45) scanned in the input so far
|- Index:     6
|- Line:      32
|- Cursor:    200
|- Column:    8
|- ---
|- Start:    Line: 32:3 - Index 195]
|- End:      Line: 32:0 - Index 192]
|- ---
|- This is word 3 of 7 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [this]
|- Current word:   [should] <---
|- Next word:      [be]
|- ---
|- State:     ELMT
|- Content:   [ this]
|- Prefix:    [#]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is ELMT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 200
After advancing : 207

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 8
After advancing : 15

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [should]
-- }}} --

-- {{{ -Word 'be' --
+-- {{{ -Column (15)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%# this should be a comment #%>
|  --------------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (46) scanned in the input so far
|- Index:     6
|- Line:      32
|- Cursor:    207
|- Column:    15
|- ---
|- Start:    Line: 32:3 - Index 195]
|- End:      Line: 32:0 - Index 192]
|- ---
|- This is word 4 of 7 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [should]
|- Current word:   [be] <---
|- Next word:      [a]
|- ---
|- State:     ELMT
|- Content:   [ this should]
|- Prefix:    [#]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is ELMT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 207
After advancing : 210

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 15
After advancing : 18

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [be]
-- }}} --

-- {{{ -Word 'a' --
+-- {{{ -Column (18)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%# this should be a comment #%>
|  -----------------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (47) scanned in the input so far
|- Index:     6
|- Line:      32
|- Cursor:    210
|- Column:    18
|- ---
|- Start:    Line: 32:3 - Index 195]
|- End:      Line: 32:0 - Index 192]
|- ---
|- This is word 5 of 7 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [be]
|- Current word:   [a] <---
|- Next word:      [comment]
|- ---
|- State:     ELMT
|- Content:   [ this should be]
|- Prefix:    [#]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is ELMT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 210
After advancing : 212

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 18
After advancing : 20

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [a]
-- }}} --

-- {{{ -Word 'comment' --
+-- {{{ -Column (20)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%# this should be a comment #%>
|  -------------------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (48) scanned in the input so far
|- Index:     6
|- Line:      32
|- Cursor:    212
|- Column:    20
|- ---
|- Start:    Line: 32:3 - Index 195]
|- End:      Line: 32:0 - Index 192]
|- ---
|- This is word 6 of 7 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [a]
|- Current word:   [comment] <---
|- Next word:      [#%>]
|- ---
|- State:     ELMT
|- Content:   [ this should be a]
|- Prefix:    [#]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is ELMT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 212
After advancing : 220

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 20
After advancing : 28

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [comment]
-- }}} --

-- {{{ -Word '\#%>' --
+-- {{{ -Column (28)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%# this should be a comment #%>
|  ---------------------------^
+------------------------------------------------------ }}} --
- Last word in line
-- {{{ info block --
| This is word (49) scanned in the input so far
|- Index:     6
|- Line:      32
|- Cursor:    220
|- Column:    28
|- ---
|- Start:    Line: 32:3 - Index 195]
|- End:      Line: 32:0 - Index 192]
|- ---
|- This is word 7 of 7 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [comment]
|- Current word:   [#%>] <---
|- Next word:      [
]
|- ---
|- State:     ELMT
|- Content:   [ this should be a comment]
|- Prefix:    [#]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: End Tag --
- Characters found before end tag
- Characters found is a Suffix
Check condition when state is ELMT
-- {{{ END TAG :: default --
lexeme is [ #%>]
- Advance the cursor and column by 4 to the end of the end tag

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 220
After advancing : 224

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 28
After advancing : 32

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
+-- {{{ -Column (32)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%# this should be a comment #%>
|  -------------------------------^
+------------------------------------------------------ }}} --

--------------------------------------------------------------------------------
-- Begin Set-EndPosition
--------------------------------------------------------------------------------
Setting End Index => 224
Setting End Column => 32
Setting End Line => 32

--------------------------------------------------------------------------------
-- End Set-EndPosition
--------------------------------------------------------------------------------
**** Create Token ****

--------------------------------------------------------------------------------
-- Begin New-TemplateToken
Received : @{
    Indent = ''
    Suffix = '#'
    Content = ' this should be a comment'
    RemainingWhiteSpace = ''
    Index = 6
    Prefix = '#'
    Type = 'elmt'
    RemoveIndent = $false
    RemoveNewLine = $false
    End = @{
        Line = 32
        Index = 224
        Column = 32
    }
    Start = @{
        Line = 32
        Index = 195
        Column = 3
    }
}

Creating Token 6: TokenInfo :
 @{
    Suffix = '#'
    Type = 'CMNT'
    Prefix = '#'
    RemoveNewLine = $false
    PSTypeName = 'Stencil.TemplateToken.Comment'
    Length = 25
    Indent = ''
    Start = @{
        Line = 32
        Index = 195
        Column = 3
    }
    End = @{
        Line = 32
        Index = 224
        Column = 32
    }
    RemainingWhiteSpace = ''
    Index = 6
    Content = ' this should be a comment'
    RemoveIndent = $false
}

-- End New-TemplateToken
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Reset-TokenOption
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- End Reset-TokenOption
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using Count parameter
Current cursor is : 224
After advancing : 225

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using Count parameter
Current column is : 32
After advancing : 33

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Set-StartPosition
--------------------------------------------------------------------------------
Setting Start Index => 225
Setting Start Column => 33
Setting Start Line => 32

--------------------------------------------------------------------------------
-- End Set-StartPosition
--------------------------------------------------------------------------------
STATE CHANGE: ELMT -> CLOSE
-------------------------------------------------------------------------}}} --
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [#%>]
-- }}} --

- Add a newline to content
- Add Line Feed
END OF LINE
-- }}} --
increment linenumber
-- {{{ -Line------------------------------------------------------------------------------
No Carriage Return found
=================================== Line 034 ====================================
Current line: ''
Split line into 1 words
-- {{{ -Word '' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  
|  ^
+------------------------------------------------------ }}} --
- Last word in line
-- {{{ info block --
| This is word (50) scanned in the input so far
|- Index:     7
|- Line:      34
|- Cursor:    225
|- Column:    0
|- ---
|- Start:    Line: 32:33 - Index 225]
|- End:      Line: 32:32 - Index 224]
|- ---
|- This is word 1 of 1 in this line
|- Is first word:  True
|- Is last word:  
|- Previous word:  [#%>]
|- Current word:   [] <---
|- Next word:      [
]
|- ---
|- State:     CLOSE
|- Content:   [
]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: whitespace --
-- }}} --
- Store current word as prevWord
Finished scanning word []
-- }}} --

- Add a newline to content
- Add Line Feed
END OF LINE
-- }}} --
-- {{{ -Line------------------------------------------------------------------------------
No Carriage Return found
=================================== Line 035 ====================================
Current line: '\ \ \ \ \ \ \ \ \ \ \ <%-\ BLOCK\ friendly-greeting\ %>'
-- {{{ Indent :: default --
-- }}} --
Removing indent from line
line is now [[regex]::Escape( <%- BLOCK friendly-greeting %>)]
Split line into 5 words
-- {{{ -Word '' --
+-- {{{ -Column (10)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|   <%- BLOCK friendly-greeting %>
|  ---------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (51) scanned in the input so far
|- Index:     7
|- Line:      35
|- Cursor:    235
|- Column:    10
|- ---
|- Start:    Line: 32:33 - Index 225]
|- End:      Line: 32:32 - Index 224]
|- ---
|- This is word 1 of 5 in this line
|- Is first word:  True
|- Is last word:  
|- Previous word:  []
|- Current word:   [] <---
|- Next word:      [<%-]
|- ---
|- State:     CLOSE
|- Content:   [
 
]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: whitespace --
-- }}} --
- Store current word as prevWord
Finished scanning word []
-- }}} --

-- {{{ -Word '<%-' --
+-- {{{ -Column (10)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|   <%- BLOCK friendly-greeting %>
|  ---------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (52) scanned in the input so far
|- Index:     7
|- Line:      35
|- Cursor:    235
|- Column:    10
|- ---
|- Start:    Line: 32:33 - Index 225]
|- End:      Line: 32:32 - Index 224]
|- ---
|- This is word 2 of 5 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  []
|- Current word:   [<%-] <---
|- Next word:      [BLOCK]
|- ---
|- State:     CLOSE
|- Content:   [
 
 ]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: Start tag --
- Characters found after start tag
Characters found is a Prefix
Check condition when state is CLOSE
-- {{{ START TAG :: default --
There is content from the previous block.  Create token
- Set End position for the previous content before advancing
+-- {{{ -Column (10)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|   <%- BLOCK friendly-greeting %>
|  ---------^
+------------------------------------------------------ }}} --

--------------------------------------------------------------------------------
-- Begin Set-EndPosition
--------------------------------------------------------------------------------
Setting End Index => 235
Setting End Column => 10
Setting End Line => 35

--------------------------------------------------------------------------------
-- End Set-EndPosition
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin New-TemplateToken
Received : @{
    Indent = ''
    Suffix = ''
    Content = '
 
 '
    RemainingWhiteSpace = ''
    Index = 7
    Prefix = ''
    Type = 'text'
    RemoveIndent = $false
    RemoveNewLine = $false
    End = @{
        Line = 35
        Index = 235
        Column = 10
    }
    Start = @{
        Line = 32
        Index = 225
        Column = 33
    }
}

Creating Token 7: TokenInfo :
 @{
    Suffix = ''
    Type = 'TEXT'
    Prefix = ''
    RemoveNewLine = $false
    PSTypeName = 'Stencil.TemplateToken.Text'
    Length = 4
    Indent = ''
    Start = @{
        Line = 32
        Index = 225
        Column = 33
    }
    End = @{
        Line = 35
        Index = 235
        Column = 10
    }
    RemainingWhiteSpace = ''
    Index = 7
    Content = '
 
 '
    RemoveIndent = $false
}

-- End New-TemplateToken
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 235
After advancing : 239

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 10
After advancing : 14

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Reset-TokenOption
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- End Reset-TokenOption
--------------------------------------------------------------------------------
+-- {{{ -Column (14)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|   <%- BLOCK friendly-greeting %>
|  -------------^
+------------------------------------------------------ }}} --

--------------------------------------------------------------------------------
-- Begin Set-StartPosition
--------------------------------------------------------------------------------
Setting Start Index => 239
Setting Start Column => 14
Setting Start Line => 35

--------------------------------------------------------------------------------
-- End Set-StartPosition
--------------------------------------------------------------------------------
STATE CHANGE: CLOSE -> OPEN
- Store current word as prevWord
Finished scanning word [<%-]
-- }}} --

-- {{{ -Word 'BLOCK' --
+-- {{{ -Column (14)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|   <%- BLOCK friendly-greeting %>
|  -------------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (53) scanned in the input so far
|- Index:     8
|- Line:      35
|- Cursor:    239
|- Column:    14
|- ---
|- Start:    Line: 35:14 - Index 239]
|- End:      Line: 35:10 - Index 235]
|- ---
|- This is word 3 of 5 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [<%-]
|- Current word:   [BLOCK] <---
|- Next word:      [friendly-greeting]
|- ---
|- State:     OPEN
|- Content:   []
|- Prefix:    [-]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is OPEN
- state condition: OPEN
STATE CHANGE: OPEN -> ELMT
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 239
After advancing : 245

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 14
After advancing : 20

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [BLOCK]
-- }}} --

-- {{{ -Word 'friendly-greeting' --
+-- {{{ -Column (20)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|   <%- BLOCK friendly-greeting %>
|  -------------------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (54) scanned in the input so far
|- Index:     8
|- Line:      35
|- Cursor:    245
|- Column:    20
|- ---
|- Start:    Line: 35:14 - Index 239]
|- End:      Line: 35:10 - Index 235]
|- ---
|- This is word 4 of 5 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [BLOCK]
|- Current word:   [friendly-greeting] <---
|- Next word:      [%>]
|- ---
|- State:     ELMT
|- Content:   [ BLOCK]
|- Prefix:    [-]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is ELMT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 245
After advancing : 263

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 20
After advancing : 38

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [friendly-greeting]
-- }}} --

-- {{{ -Word '%>' --
+-- {{{ -Column (38)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|   <%- BLOCK friendly-greeting %>
|  -------------------------------------^
+------------------------------------------------------ }}} --
- Last word in line
-- {{{ info block --
| This is word (55) scanned in the input so far
|- Index:     8
|- Line:      35
|- Cursor:    263
|- Column:    38
|- ---
|- Start:    Line: 35:14 - Index 239]
|- End:      Line: 35:10 - Index 235]
|- ---
|- This is word 5 of 5 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [friendly-greeting]
|- Current word:   [%>] <---
|- Next word:      [
]
|- ---
|- State:     ELMT
|- Content:   [ BLOCK friendly-greeting]
|- Prefix:    [-]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: End Tag --
-- No characters found before end tag
Check condition when state is ELMT
-- {{{ END TAG :: default --
lexeme is [ %>]
- Advance the cursor and column by 3 to the end of the end tag

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 263
After advancing : 266

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 38
After advancing : 41

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
+-- {{{ -Column (41)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|   <%- BLOCK friendly-greeting %>
|  ----------------------------------------^
+------------------------------------------------------ }}} --

--------------------------------------------------------------------------------
-- Begin Set-EndPosition
--------------------------------------------------------------------------------
Setting End Index => 266
Setting End Column => 41
Setting End Line => 35

--------------------------------------------------------------------------------
-- End Set-EndPosition
--------------------------------------------------------------------------------
**** Create Token ****

--------------------------------------------------------------------------------
-- Begin New-TemplateToken
Received : @{
    Indent = '           '
    Suffix = ''
    Content = ' BLOCK friendly-greeting'
    RemainingWhiteSpace = ''
    Index = 8
    Prefix = '-'
    Type = 'elmt'
    RemoveIndent = $false
    RemoveNewLine = $false
    End = @{
        Line = 35
        Index = 266
        Column = 41
    }
    Start = @{
        Line = 35
        Index = 239
        Column = 14
    }
}

Creating Token 8: TokenInfo :
 @{
    Suffix = ''
    Type = 'ELMT'
    Prefix = '-'
    RemoveNewLine = $false
    PSTypeName = 'Stencil.TemplateToken.Elmt'
    Length = 24
    Indent = '           '
    Start = @{
        Line = 35
        Index = 239
        Column = 14
    }
    End = @{
        Line = 35
        Index = 266
        Column = 41
    }
    RemainingWhiteSpace = ''
    Index = 8
    Content = ' BLOCK friendly-greeting'
    RemoveIndent = $true
}

-- End New-TemplateToken
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Reset-TokenOption
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- End Reset-TokenOption
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using Count parameter
Current cursor is : 266
After advancing : 267

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using Count parameter
Current column is : 41
After advancing : 42

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Set-StartPosition
--------------------------------------------------------------------------------
Setting Start Index => 267
Setting Start Column => 42
Setting Start Line => 35

--------------------------------------------------------------------------------
-- End Set-StartPosition
--------------------------------------------------------------------------------
STATE CHANGE: ELMT -> CLOSE
-------------------------------------------------------------------------}}} --
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [%>]
-- }}} --

- Add a newline to content
- Add Line Feed
END OF LINE
-- }}} --
-- {{{ -Line------------------------------------------------------------------------------
No Carriage Return found
=================================== Line 036 ====================================
Current line: ''
Split line into 1 words
-- {{{ -Word '' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  
|  ^
+------------------------------------------------------ }}} --
- Last word in line
-- {{{ info block --
| This is word (56) scanned in the input so far
|- Index:     9
|- Line:      36
|- Cursor:    267
|- Column:    0
|- ---
|- Start:    Line: 35:42 - Index 267]
|- End:      Line: 35:41 - Index 266]
|- ---
|- This is word 1 of 1 in this line
|- Is first word:  True
|- Is last word:  
|- Previous word:  [%>]
|- Current word:   [] <---
|- Next word:      [
]
|- ---
|- State:     CLOSE
|- Content:   [
]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: whitespace --
-- }}} --
- Store current word as prevWord
Finished scanning word []
-- }}} --

- Add a newline to content
- Add Line Feed
END OF LINE
-- }}} --
-- {{{ -Line------------------------------------------------------------------------------
No Carriage Return found
=================================== Line 037 ====================================
Current line: 'This\ should\ say\ 'Hello\ World!'\ :\ <%=\ \$Greeting\ %>\ World!'
Split line into 10 words
-- {{{ -Word 'This' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  This should say 'Hello World!' : <%= $Greeting %> World!
|  ^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (57) scanned in the input so far
|- Index:     9
|- Line:      37
|- Cursor:    267
|- Column:    0
|- ---
|- Start:    Line: 35:42 - Index 267]
|- End:      Line: 35:41 - Index 266]
|- ---
|- This is word 1 of 10 in this line
|- Is first word:  True
|- Is last word:  
|- Previous word:  []
|- Current word:   [This] <---
|- Next word:      [should]
|- ---
|- State:     CLOSE
|- Content:   [
 
]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is CLOSE
- state condition: CLOSE
STATE CHANGE: CLOSE -> TEXT

--------------------------------------------------------------------------------
-- Begin Set-StartPosition
--------------------------------------------------------------------------------
Setting Start Index => 267
Setting Start Column => 0
Setting Start Line => 37

--------------------------------------------------------------------------------
-- End Set-StartPosition
--------------------------------------------------------------------------------
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 267
After advancing : 271

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 0
After advancing : 4

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [This]
-- }}} --

-- {{{ -Word 'should' --
+-- {{{ -Column (4)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  This should say 'Hello World!' : <%= $Greeting %> World!
|  ---^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (58) scanned in the input so far
|- Index:     9
|- Line:      37
|- Cursor:    271
|- Column:    4
|- ---
|- Start:    Line: 37:0 - Index 267]
|- End:      Line: 35:41 - Index 266]
|- ---
|- This is word 2 of 10 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [This]
|- Current word:   [should] <---
|- Next word:      [say]
|- ---
|- State:     TEXT
|- Content:   [
 
This]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is TEXT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 271
After advancing : 278

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 4
After advancing : 11

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [should]
-- }}} --

-- {{{ -Word 'say' --
+-- {{{ -Column (11)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  This should say 'Hello World!' : <%= $Greeting %> World!
|  ----------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (59) scanned in the input so far
|- Index:     9
|- Line:      37
|- Cursor:    278
|- Column:    11
|- ---
|- Start:    Line: 37:0 - Index 267]
|- End:      Line: 35:41 - Index 266]
|- ---
|- This is word 3 of 10 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [should]
|- Current word:   [say] <---
|- Next word:      ['Hello]
|- ---
|- State:     TEXT
|- Content:   [
 
This should]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is TEXT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 278
After advancing : 282

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 11
After advancing : 15

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [say]
-- }}} --

-- {{{ -Word ''Hello' --
+-- {{{ -Column (15)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  This should say 'Hello World!' : <%= $Greeting %> World!
|  --------------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (60) scanned in the input so far
|- Index:     9
|- Line:      37
|- Cursor:    282
|- Column:    15
|- ---
|- Start:    Line: 37:0 - Index 267]
|- End:      Line: 35:41 - Index 266]
|- ---
|- This is word 4 of 10 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [say]
|- Current word:   ['Hello] <---
|- Next word:      [World!']
|- ---
|- State:     TEXT
|- Content:   [
 
This should say]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is TEXT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 282
After advancing : 289

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 15
After advancing : 22

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word ['Hello]
-- }}} --

-- {{{ -Word 'World!'' --
+-- {{{ -Column (22)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  This should say 'Hello World!' : <%= $Greeting %> World!
|  ---------------------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (61) scanned in the input so far
|- Index:     9
|- Line:      37
|- Cursor:    289
|- Column:    22
|- ---
|- Start:    Line: 37:0 - Index 267]
|- End:      Line: 35:41 - Index 266]
|- ---
|- This is word 5 of 10 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  ['Hello]
|- Current word:   [World!'] <---
|- Next word:      [:]
|- ---
|- State:     TEXT
|- Content:   [
 
This should say 'Hello]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is TEXT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 289
After advancing : 297

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 22
After advancing : 30

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [World!']
-- }}} --

-- {{{ -Word ':' --
+-- {{{ -Column (30)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  This should say 'Hello World!' : <%= $Greeting %> World!
|  -----------------------------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (62) scanned in the input so far
|- Index:     9
|- Line:      37
|- Cursor:    297
|- Column:    30
|- ---
|- Start:    Line: 37:0 - Index 267]
|- End:      Line: 35:41 - Index 266]
|- ---
|- This is word 6 of 10 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [World!']
|- Current word:   [:] <---
|- Next word:      [<%=]
|- ---
|- State:     TEXT
|- Content:   [
 
This should say 'Hello World!']
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is TEXT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 297
After advancing : 299

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 30
After advancing : 32

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [:]
-- }}} --

-- {{{ -Word '<%=' --
+-- {{{ -Column (32)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  This should say 'Hello World!' : <%= $Greeting %> World!
|  -------------------------------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (63) scanned in the input so far
|- Index:     9
|- Line:      37
|- Cursor:    299
|- Column:    32
|- ---
|- Start:    Line: 37:0 - Index 267]
|- End:      Line: 35:41 - Index 266]
|- ---
|- This is word 7 of 10 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [:]
|- Current word:   [<%=] <---
|- Next word:      [$Greeting]
|- ---
|- State:     TEXT
|- Content:   [
 
This should say 'Hello World!' :]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: Start tag --
- Characters found after start tag
Characters found is a Prefix
Check condition when state is TEXT
-- {{{ START TAG :: default --
There is content from the previous block.  Create token
- Set End position for the previous content before advancing
+-- {{{ -Column (32)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  This should say 'Hello World!' : <%= $Greeting %> World!
|  -------------------------------^
+------------------------------------------------------ }}} --

--------------------------------------------------------------------------------
-- Begin Set-EndPosition
--------------------------------------------------------------------------------
Setting End Index => 299
Setting End Column => 32
Setting End Line => 37

--------------------------------------------------------------------------------
-- End Set-EndPosition
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin New-TemplateToken
Received : @{
    Indent = ''
    Suffix = ''
    Content = '
 
This should say ''Hello World!'' :'
    RemainingWhiteSpace = ''
    Index = 9
    Prefix = ''
    Type = 'text'
    RemoveIndent = $false
    RemoveNewLine = $false
    End = @{
        Line = 37
        Index = 299
        Column = 32
    }
    Start = @{
        Line = 37
        Index = 267
        Column = 0
    }
}

Creating Token 9: TokenInfo :
 @{
    Suffix = ''
    Type = 'TEXT'
    Prefix = ''
    RemoveNewLine = $false
    PSTypeName = 'Stencil.TemplateToken.Text'
    Length = 35
    Indent = ''
    Start = @{
        Line = 37
        Index = 267
        Column = 0
    }
    End = @{
        Line = 37
        Index = 299
        Column = 32
    }
    RemainingWhiteSpace = ''
    Index = 9
    Content = '
 
This should say ''Hello World!'' :'
    RemoveIndent = $false
}

-- End New-TemplateToken
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 299
After advancing : 301

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 32
After advancing : 34

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Reset-TokenOption
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- End Reset-TokenOption
--------------------------------------------------------------------------------
+-- {{{ -Column (34)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  This should say 'Hello World!' : <%= $Greeting %> World!
|  ---------------------------------^
+------------------------------------------------------ }}} --

--------------------------------------------------------------------------------
-- Begin Set-StartPosition
--------------------------------------------------------------------------------
Setting Start Index => 301
Setting Start Column => 34
Setting Start Line => 37

--------------------------------------------------------------------------------
-- End Set-StartPosition
--------------------------------------------------------------------------------
STATE CHANGE: TEXT -> OPEN
- Store current word as prevWord
Finished scanning word [<%=]
-- }}} --

-- {{{ -Word '\$Greeting' --
+-- {{{ -Column (34)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  This should say 'Hello World!' : <%= $Greeting %> World!
|  ---------------------------------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (64) scanned in the input so far
|- Index:     10
|- Line:      37
|- Cursor:    301
|- Column:    34
|- ---
|- Start:    Line: 37:34 - Index 301]
|- End:      Line: 37:32 - Index 299]
|- ---
|- This is word 8 of 10 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [<%=]
|- Current word:   [$Greeting] <---
|- Next word:      [%>]
|- ---
|- State:     OPEN
|- Content:   []
|- Prefix:    [=]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is OPEN
- state condition: OPEN
STATE CHANGE: OPEN -> ELMT
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 301
After advancing : 311

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 34
After advancing : 44

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [$Greeting]
-- }}} --

-- {{{ -Word '%>' --
+-- {{{ -Column (44)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  This should say 'Hello World!' : <%= $Greeting %> World!
|  -------------------------------------------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (65) scanned in the input so far
|- Index:     10
|- Line:      37
|- Cursor:    311
|- Column:    44
|- ---
|- Start:    Line: 37:34 - Index 301]
|- End:      Line: 37:32 - Index 299]
|- ---
|- This is word 9 of 10 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [$Greeting]
|- Current word:   [%>] <---
|- Next word:      [World!]
|- ---
|- State:     ELMT
|- Content:   [ $Greeting]
|- Prefix:    [=]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: End Tag --
-- No characters found before end tag
Check condition when state is ELMT
-- {{{ END TAG :: default --
lexeme is [ %>]
- Advance the cursor and column by 3 to the end of the end tag

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 311
After advancing : 314

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 44
After advancing : 47

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
+-- {{{ -Column (47)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  This should say 'Hello World!' : <%= $Greeting %> World!
|  ----------------------------------------------^
+------------------------------------------------------ }}} --

--------------------------------------------------------------------------------
-- Begin Set-EndPosition
--------------------------------------------------------------------------------
Setting End Index => 314
Setting End Column => 47
Setting End Line => 37

--------------------------------------------------------------------------------
-- End Set-EndPosition
--------------------------------------------------------------------------------
**** Create Token ****

--------------------------------------------------------------------------------
-- Begin New-TemplateToken
Received : @{
    Indent = ''
    Suffix = ''
    Content = ' $Greeting'
    RemainingWhiteSpace = ''
    Index = 10
    Prefix = '='
    Type = 'elmt'
    RemoveIndent = $false
    RemoveNewLine = $false
    End = @{
        Line = 37
        Index = 314
        Column = 47
    }
    Start = @{
        Line = 37
        Index = 301
        Column = 34
    }
}

Creating Token 10: TokenInfo :
 @{
    Suffix = ''
    Type = 'STMT'
    Prefix = '='
    RemoveNewLine = $false
    PSTypeName = 'Stencil.TemplateToken.Statement'
    Length = 10
    Indent = ''
    Start = @{
        Line = 37
        Index = 301
        Column = 34
    }
    End = @{
        Line = 37
        Index = 314
        Column = 47
    }
    RemainingWhiteSpace = ''
    Index = 10
    Content = ' $Greeting'
    RemoveIndent = $false
}

-- End New-TemplateToken
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Reset-TokenOption
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- End Reset-TokenOption
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using Count parameter
Current cursor is : 314
After advancing : 315

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using Count parameter
Current column is : 47
After advancing : 48

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Set-StartPosition
--------------------------------------------------------------------------------
Setting Start Index => 315
Setting Start Column => 48
Setting Start Line => 37

--------------------------------------------------------------------------------
-- End Set-StartPosition
--------------------------------------------------------------------------------
STATE CHANGE: ELMT -> CLOSE
-------------------------------------------------------------------------}}} --
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [%>]
-- }}} --

-- {{{ -Word 'World!' --
+-- {{{ -Column (48)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  This should say 'Hello World!' : <%= $Greeting %> World!
|  -----------------------------------------------^
+------------------------------------------------------ }}} --
- Last word in line
-- {{{ info block --
| This is word (66) scanned in the input so far
|- Index:     11
|- Line:      37
|- Cursor:    315
|- Column:    48
|- ---
|- Start:    Line: 37:48 - Index 315]
|- End:      Line: 37:47 - Index 314]
|- ---
|- This is word 10 of 10 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [%>]
|- Current word:   [World!] <---
|- Next word:      [
]
|- ---
|- State:     CLOSE
|- Content:   []
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is CLOSE
- state condition: CLOSE
STATE CHANGE: CLOSE -> TEXT

--------------------------------------------------------------------------------
-- Begin Set-StartPosition
--------------------------------------------------------------------------------
Setting Start Index => 315
Setting Start Column => 48
Setting Start Line => 37

--------------------------------------------------------------------------------
-- End Set-StartPosition
--------------------------------------------------------------------------------
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 315
After advancing : 322

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 48
After advancing : 55

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [World!]
-- }}} --

- Add a newline to content
- Add Line Feed
END OF LINE
-- }}} --
-- {{{ -Line------------------------------------------------------------------------------
No Carriage Return found
=================================== Line 038 ====================================
Current line: ''
Split line into 1 words
-- {{{ -Word '' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  
|  ^
+------------------------------------------------------ }}} --
- Last word in line
-- {{{ info block --
| This is word (67) scanned in the input so far
|- Index:     11
|- Line:      38
|- Cursor:    322
|- Column:    0
|- ---
|- Start:    Line: 37:48 - Index 315]
|- End:      Line: 37:47 - Index 314]
|- ---
|- This is word 1 of 1 in this line
|- Is first word:  True
|- Is last word:  
|- Previous word:  [World!]
|- Current word:   [] <---
|- Next word:      [
]
|- ---
|- State:     TEXT
|- Content:   [ World!
]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: whitespace --
-- }}} --
- Store current word as prevWord
Finished scanning word []
-- }}} --

- Add a newline to content
- Add Line Feed
END OF LINE
-- }}} --
-- {{{ -Line------------------------------------------------------------------------------
No Carriage Return found
=================================== Line 039 ====================================
Current line: '<%\ END\ %>'
Split line into 3 words
-- {{{ -Word '<%' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <% END %>
|  ^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (68) scanned in the input so far
|- Index:     11
|- Line:      39
|- Cursor:    322
|- Column:    0
|- ---
|- Start:    Line: 37:48 - Index 315]
|- End:      Line: 37:47 - Index 314]
|- ---
|- This is word 1 of 3 in this line
|- Is first word:  True
|- Is last word:  
|- Previous word:  []
|- Current word:   [<%] <---
|- Next word:      [END]
|- ---
|- State:     TEXT
|- Content:   [ World!
 
]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: Start tag --
-- No characters found after start tag
Check condition when state is TEXT
-- {{{ START TAG :: default --
There is content from the previous block.  Create token
- Set End position for the previous content before advancing
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <% END %>
|  ^
+------------------------------------------------------ }}} --

--------------------------------------------------------------------------------
-- Begin Set-EndPosition
--------------------------------------------------------------------------------
Setting End Index => 322
Setting End Column => 0
Setting End Line => 39

--------------------------------------------------------------------------------
-- End Set-EndPosition
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin New-TemplateToken
Received : @{
    Indent = ''
    Suffix = ''
    Content = ' World!
 
'
    RemainingWhiteSpace = ''
    Index = 11
    Prefix = ''
    Type = 'text'
    RemoveIndent = $false
    RemoveNewLine = $false
    End = @{
        Line = 39
        Index = 322
        Column = 0
    }
    Start = @{
        Line = 37
        Index = 315
        Column = 48
    }
}

Creating Token 11: TokenInfo :
 @{
    Suffix = ''
    Type = 'TEXT'
    Prefix = ''
    RemoveNewLine = $false
    PSTypeName = 'Stencil.TemplateToken.Text'
    Length = 10
    Indent = ''
    Start = @{
        Line = 37
        Index = 315
        Column = 48
    }
    End = @{
        Line = 39
        Index = 322
        Column = 0
    }
    RemainingWhiteSpace = ''
    Index = 11
    Content = ' World!
 
'
    RemoveIndent = $false
}

-- End New-TemplateToken
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 322
After advancing : 329

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 0
After advancing : 7

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Reset-TokenOption
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- End Reset-TokenOption
--------------------------------------------------------------------------------
+-- {{{ -Column (7)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <% END %>
|  ------^
+------------------------------------------------------ }}} --

--------------------------------------------------------------------------------
-- Begin Set-StartPosition
--------------------------------------------------------------------------------
Setting Start Index => 329
Setting Start Column => 7
Setting Start Line => 39

--------------------------------------------------------------------------------
-- End Set-StartPosition
--------------------------------------------------------------------------------
STATE CHANGE: TEXT -> OPEN
- Store current word as prevWord
Finished scanning word [<%]
-- }}} --

-- {{{ -Word 'END' --
+-- {{{ -Column (7)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <% END %>
|  ------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (69) scanned in the input so far
|- Index:     12
|- Line:      39
|- Cursor:    329
|- Column:    7
|- ---
|- Start:    Line: 39:7 - Index 329]
|- End:      Line: 39:0 - Index 322]
|- ---
|- This is word 2 of 3 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [<%]
|- Current word:   [END] <---
|- Next word:      [%>]
|- ---
|- State:     OPEN
|- Content:   []
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is OPEN
- state condition: OPEN
STATE CHANGE: OPEN -> ELMT
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 329
After advancing : 333

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 7
After advancing : 11

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [END]
-- }}} --

-- {{{ -Word '%>' --
+-- {{{ -Column (11)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <% END %>
|  ----------^
+------------------------------------------------------ }}} --
- Last word in line
-- {{{ info block --
| This is word (70) scanned in the input so far
|- Index:     12
|- Line:      39
|- Cursor:    333
|- Column:    11
|- ---
|- Start:    Line: 39:7 - Index 329]
|- End:      Line: 39:0 - Index 322]
|- ---
|- This is word 3 of 3 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [END]
|- Current word:   [%>] <---
|- Next word:      [
]
|- ---
|- State:     ELMT
|- Content:   [ END]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: End Tag --
-- No characters found before end tag
Check condition when state is ELMT
-- {{{ END TAG :: default --
lexeme is [ %>]
- Advance the cursor and column by 3 to the end of the end tag

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 333
After advancing : 336

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 11
After advancing : 14

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
+-- {{{ -Column (14)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <% END %>
|  -------------^
+------------------------------------------------------ }}} --

--------------------------------------------------------------------------------
-- Begin Set-EndPosition
--------------------------------------------------------------------------------
Setting End Index => 336
Setting End Column => 14
Setting End Line => 39

--------------------------------------------------------------------------------
-- End Set-EndPosition
--------------------------------------------------------------------------------
**** Create Token ****

--------------------------------------------------------------------------------
-- Begin New-TemplateToken
Received : @{
    Indent = ''
    Suffix = ''
    Content = ' END'
    RemainingWhiteSpace = ''
    Index = 12
    Prefix = ''
    Type = 'elmt'
    RemoveIndent = $false
    RemoveNewLine = $false
    End = @{
        Line = 39
        Index = 336
        Column = 14
    }
    Start = @{
        Line = 39
        Index = 329
        Column = 7
    }
}

Creating Token 12: TokenInfo :
 @{
    Suffix = ''
    Type = 'ELMT'
    Prefix = ''
    RemoveNewLine = $false
    PSTypeName = 'Stencil.TemplateToken.Elmt'
    Length = 4
    Indent = ''
    Start = @{
        Line = 39
        Index = 329
        Column = 7
    }
    End = @{
        Line = 39
        Index = 336
        Column = 14
    }
    RemainingWhiteSpace = ''
    Index = 12
    Content = ' END'
    RemoveIndent = $false
}

-- End New-TemplateToken
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Reset-TokenOption
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- End Reset-TokenOption
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using Count parameter
Current cursor is : 336
After advancing : 337

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using Count parameter
Current column is : 14
After advancing : 15

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Set-StartPosition
--------------------------------------------------------------------------------
Setting Start Index => 337
Setting Start Column => 15
Setting Start Line => 39

--------------------------------------------------------------------------------
-- End Set-StartPosition
--------------------------------------------------------------------------------
STATE CHANGE: ELMT -> CLOSE
-------------------------------------------------------------------------}}} --
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [%>]
-- }}} --

- Add a newline to content
- Add Line Feed
END OF LINE
-- }}} --
-- {{{ -Line------------------------------------------------------------------------------
No Carriage Return found
=================================== Line 040 ====================================
Current line: ''
Split line into 1 words
-- {{{ -Word '' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  
|  ^
+------------------------------------------------------ }}} --
- Last word in line
-- {{{ info block --
| This is word (71) scanned in the input so far
|- Index:     13
|- Line:      40
|- Cursor:    337
|- Column:    0
|- ---
|- Start:    Line: 39:15 - Index 337]
|- End:      Line: 39:14 - Index 336]
|- ---
|- This is word 1 of 1 in this line
|- Is first word:  True
|- Is last word:  
|- Previous word:  [%>]
|- Current word:   [] <---
|- Next word:      [
]
|- ---
|- State:     CLOSE
|- Content:   [
]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: whitespace --
-- }}} --
- Store current word as prevWord
Finished scanning word []
-- }}} --

- Add a newline to content
- Add Line Feed
END OF LINE
-- }}} --
-- {{{ -Line------------------------------------------------------------------------------
No Carriage Return found
=================================== Line 041 ====================================
Current line: 'Hope\ \ you\ <%=\ \(echo\ "all"\)\ %>\ have\ a\ nice\ day'
Split line into 11 words
-- {{{ -Word 'Hope' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  Hope  you <%= (echo "all") %> have a nice day
|  ^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (72) scanned in the input so far
|- Index:     13
|- Line:      41
|- Cursor:    337
|- Column:    0
|- ---
|- Start:    Line: 39:15 - Index 337]
|- End:      Line: 39:14 - Index 336]
|- ---
|- This is word 1 of 11 in this line
|- Is first word:  True
|- Is last word:  
|- Previous word:  []
|- Current word:   [Hope] <---
|- Next word:      []
|- ---
|- State:     CLOSE
|- Content:   [
 
]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is CLOSE
- state condition: CLOSE
STATE CHANGE: CLOSE -> TEXT

--------------------------------------------------------------------------------
-- Begin Set-StartPosition
--------------------------------------------------------------------------------
Setting Start Index => 337
Setting Start Column => 0
Setting Start Line => 41

--------------------------------------------------------------------------------
-- End Set-StartPosition
--------------------------------------------------------------------------------
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 337
After advancing : 341

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 0
After advancing : 4

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [Hope]
-- }}} --

-- {{{ -Word '' --
+-- {{{ -Column (4)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  Hope  you <%= (echo "all") %> have a nice day
|  ---^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (73) scanned in the input so far
|- Index:     13
|- Line:      41
|- Cursor:    341
|- Column:    4
|- ---
|- Start:    Line: 41:0 - Index 337]
|- End:      Line: 39:14 - Index 336]
|- ---
|- This is word 2 of 11 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [Hope]
|- Current word:   [] <---
|- Next word:      [you]
|- ---
|- State:     TEXT
|- Content:   [
 
Hope]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: whitespace --
-- }}} --
- Store current word as prevWord
Finished scanning word []
-- }}} --

-- {{{ -Word 'you' --
+-- {{{ -Column (4)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  Hope  you <%= (echo "all") %> have a nice day
|  ---^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (74) scanned in the input so far
|- Index:     13
|- Line:      41
|- Cursor:    341
|- Column:    4
|- ---
|- Start:    Line: 41:0 - Index 337]
|- End:      Line: 39:14 - Index 336]
|- ---
|- This is word 3 of 11 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  []
|- Current word:   [you] <---
|- Next word:      [<%=]
|- ---
|- State:     TEXT
|- Content:   [
 
Hope ]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is TEXT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 341
After advancing : 345

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 4
After advancing : 8

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [you]
-- }}} --

-- {{{ -Word '<%=' --
+-- {{{ -Column (8)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  Hope  you <%= (echo "all") %> have a nice day
|  -------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (75) scanned in the input so far
|- Index:     13
|- Line:      41
|- Cursor:    345
|- Column:    8
|- ---
|- Start:    Line: 41:0 - Index 337]
|- End:      Line: 39:14 - Index 336]
|- ---
|- This is word 4 of 11 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [you]
|- Current word:   [<%=] <---
|- Next word:      [(echo]
|- ---
|- State:     TEXT
|- Content:   [
 
Hope  you]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: Start tag --
- Characters found after start tag
Characters found is a Prefix
Check condition when state is TEXT
-- {{{ START TAG :: default --
There is content from the previous block.  Create token
- Set End position for the previous content before advancing
+-- {{{ -Column (8)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  Hope  you <%= (echo "all") %> have a nice day
|  -------^
+------------------------------------------------------ }}} --

--------------------------------------------------------------------------------
-- Begin Set-EndPosition
--------------------------------------------------------------------------------
Setting End Index => 345
Setting End Column => 8
Setting End Line => 41

--------------------------------------------------------------------------------
-- End Set-EndPosition
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin New-TemplateToken
Received : @{
    Indent = ''
    Suffix = ''
    Content = '
 
Hope  you'
    RemainingWhiteSpace = ''
    Index = 13
    Prefix = ''
    Type = 'text'
    RemoveIndent = $false
    RemoveNewLine = $false
    End = @{
        Line = 41
        Index = 345
        Column = 8
    }
    Start = @{
        Line = 41
        Index = 337
        Column = 0
    }
}

Creating Token 13: TokenInfo :
 @{
    Suffix = ''
    Type = 'TEXT'
    Prefix = ''
    RemoveNewLine = $false
    PSTypeName = 'Stencil.TemplateToken.Text'
    Length = 12
    Indent = ''
    Start = @{
        Line = 41
        Index = 337
        Column = 0
    }
    End = @{
        Line = 41
        Index = 345
        Column = 8
    }
    RemainingWhiteSpace = ''
    Index = 13
    Content = '
 
Hope  you'
    RemoveIndent = $false
}

-- End New-TemplateToken
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 345
After advancing : 349

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 8
After advancing : 12

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Reset-TokenOption
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- End Reset-TokenOption
--------------------------------------------------------------------------------
+-- {{{ -Column (12)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  Hope  you <%= (echo "all") %> have a nice day
|  -----------^
+------------------------------------------------------ }}} --

--------------------------------------------------------------------------------
-- Begin Set-StartPosition
--------------------------------------------------------------------------------
Setting Start Index => 349
Setting Start Column => 12
Setting Start Line => 41

--------------------------------------------------------------------------------
-- End Set-StartPosition
--------------------------------------------------------------------------------
STATE CHANGE: TEXT -> OPEN
- Store current word as prevWord
Finished scanning word [<%=]
-- }}} --

-- {{{ -Word '\(echo' --
+-- {{{ -Column (12)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  Hope  you <%= (echo "all") %> have a nice day
|  -----------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (76) scanned in the input so far
|- Index:     14
|- Line:      41
|- Cursor:    349
|- Column:    12
|- ---
|- Start:    Line: 41:12 - Index 349]
|- End:      Line: 41:8 - Index 345]
|- ---
|- This is word 5 of 11 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [<%=]
|- Current word:   [(echo] <---
|- Next word:      ["all")]
|- ---
|- State:     OPEN
|- Content:   []
|- Prefix:    [=]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is OPEN
- state condition: OPEN
STATE CHANGE: OPEN -> ELMT
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 349
After advancing : 355

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 12
After advancing : 18

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [(echo]
-- }}} --

-- {{{ -Word '"all"\)' --
+-- {{{ -Column (18)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  Hope  you <%= (echo "all") %> have a nice day
|  -----------------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (77) scanned in the input so far
|- Index:     14
|- Line:      41
|- Cursor:    355
|- Column:    18
|- ---
|- Start:    Line: 41:12 - Index 349]
|- End:      Line: 41:8 - Index 345]
|- ---
|- This is word 6 of 11 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [(echo]
|- Current word:   ["all")] <---
|- Next word:      [%>]
|- ---
|- State:     ELMT
|- Content:   [ (echo]
|- Prefix:    [=]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is ELMT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 355
After advancing : 362

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 18
After advancing : 25

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word ["all")]
-- }}} --

-- {{{ -Word '%>' --
+-- {{{ -Column (25)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  Hope  you <%= (echo "all") %> have a nice day
|  ------------------------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (78) scanned in the input so far
|- Index:     14
|- Line:      41
|- Cursor:    362
|- Column:    25
|- ---
|- Start:    Line: 41:12 - Index 349]
|- End:      Line: 41:8 - Index 345]
|- ---
|- This is word 7 of 11 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  ["all")]
|- Current word:   [%>] <---
|- Next word:      [have]
|- ---
|- State:     ELMT
|- Content:   [ (echo "all")]
|- Prefix:    [=]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: End Tag --
-- No characters found before end tag
Check condition when state is ELMT
-- {{{ END TAG :: default --
lexeme is [ %>]
- Advance the cursor and column by 3 to the end of the end tag

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 362
After advancing : 365

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 25
After advancing : 28

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
+-- {{{ -Column (28)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  Hope  you <%= (echo "all") %> have a nice day
|  ---------------------------^
+------------------------------------------------------ }}} --

--------------------------------------------------------------------------------
-- Begin Set-EndPosition
--------------------------------------------------------------------------------
Setting End Index => 365
Setting End Column => 28
Setting End Line => 41

--------------------------------------------------------------------------------
-- End Set-EndPosition
--------------------------------------------------------------------------------
**** Create Token ****

--------------------------------------------------------------------------------
-- Begin New-TemplateToken
Received : @{
    Indent = ''
    Suffix = ''
    Content = ' (echo "all")'
    RemainingWhiteSpace = ''
    Index = 14
    Prefix = '='
    Type = 'elmt'
    RemoveIndent = $false
    RemoveNewLine = $false
    End = @{
        Line = 41
        Index = 365
        Column = 28
    }
    Start = @{
        Line = 41
        Index = 349
        Column = 12
    }
}

Creating Token 14: TokenInfo :
 @{
    Suffix = ''
    Type = 'STMT'
    Prefix = '='
    RemoveNewLine = $false
    PSTypeName = 'Stencil.TemplateToken.Statement'
    Length = 13
    Indent = ''
    Start = @{
        Line = 41
        Index = 349
        Column = 12
    }
    End = @{
        Line = 41
        Index = 365
        Column = 28
    }
    RemainingWhiteSpace = ''
    Index = 14
    Content = ' (echo "all")'
    RemoveIndent = $false
}

-- End New-TemplateToken
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Reset-TokenOption
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- End Reset-TokenOption
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using Count parameter
Current cursor is : 365
After advancing : 366

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using Count parameter
Current column is : 28
After advancing : 29

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Set-StartPosition
--------------------------------------------------------------------------------
Setting Start Index => 366
Setting Start Column => 29
Setting Start Line => 41

--------------------------------------------------------------------------------
-- End Set-StartPosition
--------------------------------------------------------------------------------
STATE CHANGE: ELMT -> CLOSE
-------------------------------------------------------------------------}}} --
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [%>]
-- }}} --

-- {{{ -Word 'have' --
+-- {{{ -Column (29)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  Hope  you <%= (echo "all") %> have a nice day
|  ----------------------------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (79) scanned in the input so far
|- Index:     15
|- Line:      41
|- Cursor:    366
|- Column:    29
|- ---
|- Start:    Line: 41:29 - Index 366]
|- End:      Line: 41:28 - Index 365]
|- ---
|- This is word 8 of 11 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [%>]
|- Current word:   [have] <---
|- Next word:      [a]
|- ---
|- State:     CLOSE
|- Content:   []
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is CLOSE
- state condition: CLOSE
STATE CHANGE: CLOSE -> TEXT

--------------------------------------------------------------------------------
-- Begin Set-StartPosition
--------------------------------------------------------------------------------
Setting Start Index => 366
Setting Start Column => 29
Setting Start Line => 41

--------------------------------------------------------------------------------
-- End Set-StartPosition
--------------------------------------------------------------------------------
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 366
After advancing : 371

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 29
After advancing : 34

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [have]
-- }}} --

-- {{{ -Word 'a' --
+-- {{{ -Column (34)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  Hope  you <%= (echo "all") %> have a nice day
|  ---------------------------------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (80) scanned in the input so far
|- Index:     15
|- Line:      41
|- Cursor:    371
|- Column:    34
|- ---
|- Start:    Line: 41:29 - Index 366]
|- End:      Line: 41:28 - Index 365]
|- ---
|- This is word 9 of 11 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [have]
|- Current word:   [a] <---
|- Next word:      [nice]
|- ---
|- State:     TEXT
|- Content:   [ have]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is TEXT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 371
After advancing : 373

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 34
After advancing : 36

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [a]
-- }}} --

-- {{{ -Word 'nice' --
+-- {{{ -Column (36)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  Hope  you <%= (echo "all") %> have a nice day
|  -----------------------------------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (81) scanned in the input so far
|- Index:     15
|- Line:      41
|- Cursor:    373
|- Column:    36
|- ---
|- Start:    Line: 41:29 - Index 366]
|- End:      Line: 41:28 - Index 365]
|- ---
|- This is word 10 of 11 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [a]
|- Current word:   [nice] <---
|- Next word:      [day]
|- ---
|- State:     TEXT
|- Content:   [ have a]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is TEXT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 373
After advancing : 378

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 36
After advancing : 41

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [nice]
-- }}} --

-- {{{ -Word 'day' --
+-- {{{ -Column (41)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  Hope  you <%= (echo "all") %> have a nice day
|  ----------------------------------------^
+------------------------------------------------------ }}} --
- Last word in line
-- {{{ info block --
| This is word (82) scanned in the input so far
|- Index:     15
|- Line:      41
|- Cursor:    378
|- Column:    41
|- ---
|- Start:    Line: 41:29 - Index 366]
|- End:      Line: 41:28 - Index 365]
|- ---
|- This is word 11 of 11 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [nice]
|- Current word:   [day] <---
|- Next word:      [
]
|- ---
|- State:     TEXT
|- Content:   [ have a nice]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is TEXT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 378
After advancing : 382

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 41
After advancing : 45

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [day]
-- }}} --

- Add a newline to content
- Add Line Feed
END OF LINE
-- }}} --
-- {{{ -Line------------------------------------------------------------------------------
No Carriage Return found
=================================== Line 042 ====================================
Current line: ''
Split line into 1 words
-- {{{ -Word '' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  
|  ^
+------------------------------------------------------ }}} --
- Last word in line
-- {{{ info block --
| This is word (83) scanned in the input so far
|- Index:     15
|- Line:      42
|- Cursor:    382
|- Column:    0
|- ---
|- Start:    Line: 41:29 - Index 366]
|- End:      Line: 41:28 - Index 365]
|- ---
|- This is word 1 of 1 in this line
|- Is first word:  True
|- Is last word:  
|- Previous word:  [day]
|- Current word:   [] <---
|- Next word:      [
]
|- ---
|- State:     TEXT
|- Content:   [ have a nice day
]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: whitespace --
-- }}} --
- Store current word as prevWord
Finished scanning word []
-- }}} --

- Add a newline to content
- Add Line Feed
END OF LINE
-- }}} --
-- {{{ -Line------------------------------------------------------------------------------
No Carriage Return found
=================================== Line 043 ====================================
Current line: '<%\ foreach\ \(\$item\ in\ \$items\)\ \{'
Split line into 6 words
-- {{{ -Word '<%' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <% foreach ($item in $items) {
|  ^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (84) scanned in the input so far
|- Index:     15
|- Line:      43
|- Cursor:    382
|- Column:    0
|- ---
|- Start:    Line: 41:29 - Index 366]
|- End:      Line: 41:28 - Index 365]
|- ---
|- This is word 1 of 6 in this line
|- Is first word:  True
|- Is last word:  
|- Previous word:  []
|- Current word:   [<%] <---
|- Next word:      [foreach]
|- ---
|- State:     TEXT
|- Content:   [ have a nice day
 
]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: Start tag --
-- No characters found after start tag
Check condition when state is TEXT
-- {{{ START TAG :: default --
There is content from the previous block.  Create token
- Set End position for the previous content before advancing
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <% foreach ($item in $items) {
|  ^
+------------------------------------------------------ }}} --

--------------------------------------------------------------------------------
-- Begin Set-EndPosition
--------------------------------------------------------------------------------
Setting End Index => 382
Setting End Column => 0
Setting End Line => 43

--------------------------------------------------------------------------------
-- End Set-EndPosition
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin New-TemplateToken
Received : @{
    Indent = ''
    Suffix = ''
    Content = ' have a nice day
 
'
    RemainingWhiteSpace = ''
    Index = 15
    Prefix = ''
    Type = 'text'
    RemoveIndent = $false
    RemoveNewLine = $false
    End = @{
        Line = 43
        Index = 382
        Column = 0
    }
    Start = @{
        Line = 41
        Index = 366
        Column = 29
    }
}

Creating Token 15: TokenInfo :
 @{
    Suffix = ''
    Type = 'TEXT'
    Prefix = ''
    RemoveNewLine = $false
    PSTypeName = 'Stencil.TemplateToken.Text'
    Length = 19
    Indent = ''
    Start = @{
        Line = 41
        Index = 366
        Column = 29
    }
    End = @{
        Line = 43
        Index = 382
        Column = 0
    }
    RemainingWhiteSpace = ''
    Index = 15
    Content = ' have a nice day
 
'
    RemoveIndent = $false
}

-- End New-TemplateToken
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 382
After advancing : 386

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 0
After advancing : 4

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Reset-TokenOption
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- End Reset-TokenOption
--------------------------------------------------------------------------------
+-- {{{ -Column (4)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <% foreach ($item in $items) {
|  ---^
+------------------------------------------------------ }}} --

--------------------------------------------------------------------------------
-- Begin Set-StartPosition
--------------------------------------------------------------------------------
Setting Start Index => 386
Setting Start Column => 4
Setting Start Line => 43

--------------------------------------------------------------------------------
-- End Set-StartPosition
--------------------------------------------------------------------------------
STATE CHANGE: TEXT -> OPEN
- Store current word as prevWord
Finished scanning word [<%]
-- }}} --

-- {{{ -Word 'foreach' --
+-- {{{ -Column (4)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <% foreach ($item in $items) {
|  ---^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (85) scanned in the input so far
|- Index:     16
|- Line:      43
|- Cursor:    386
|- Column:    4
|- ---
|- Start:    Line: 43:4 - Index 386]
|- End:      Line: 43:0 - Index 382]
|- ---
|- This is word 2 of 6 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [<%]
|- Current word:   [foreach] <---
|- Next word:      [($item]
|- ---
|- State:     OPEN
|- Content:   []
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is OPEN
- state condition: OPEN
STATE CHANGE: OPEN -> ELMT
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 386
After advancing : 394

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 4
After advancing : 12

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [foreach]
-- }}} --

-- {{{ -Word '\(\$item' --
+-- {{{ -Column (12)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <% foreach ($item in $items) {
|  -----------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (86) scanned in the input so far
|- Index:     16
|- Line:      43
|- Cursor:    394
|- Column:    12
|- ---
|- Start:    Line: 43:4 - Index 386]
|- End:      Line: 43:0 - Index 382]
|- ---
|- This is word 3 of 6 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [foreach]
|- Current word:   [($item] <---
|- Next word:      [in]
|- ---
|- State:     ELMT
|- Content:   [ foreach]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is ELMT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 394
After advancing : 401

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 12
After advancing : 19

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [($item]
-- }}} --

-- {{{ -Word 'in' --
+-- {{{ -Column (19)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <% foreach ($item in $items) {
|  ------------------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (87) scanned in the input so far
|- Index:     16
|- Line:      43
|- Cursor:    401
|- Column:    19
|- ---
|- Start:    Line: 43:4 - Index 386]
|- End:      Line: 43:0 - Index 382]
|- ---
|- This is word 4 of 6 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [($item]
|- Current word:   [in] <---
|- Next word:      [$items)]
|- ---
|- State:     ELMT
|- Content:   [ foreach ($item]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is ELMT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 401
After advancing : 404

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 19
After advancing : 22

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [in]
-- }}} --

-- {{{ -Word '\$items\)' --
+-- {{{ -Column (22)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <% foreach ($item in $items) {
|  ---------------------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (88) scanned in the input so far
|- Index:     16
|- Line:      43
|- Cursor:    404
|- Column:    22
|- ---
|- Start:    Line: 43:4 - Index 386]
|- End:      Line: 43:0 - Index 382]
|- ---
|- This is word 5 of 6 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [in]
|- Current word:   [$items)] <---
|- Next word:      [{]
|- ---
|- State:     ELMT
|- Content:   [ foreach ($item in]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is ELMT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 404
After advancing : 412

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 22
After advancing : 30

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [$items)]
-- }}} --

-- {{{ -Word '\{' --
+-- {{{ -Column (30)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <% foreach ($item in $items) {
|  -----------------------------^
+------------------------------------------------------ }}} --
- Last word in line
-- {{{ info block --
| This is word (89) scanned in the input so far
|- Index:     16
|- Line:      43
|- Cursor:    412
|- Column:    30
|- ---
|- Start:    Line: 43:4 - Index 386]
|- End:      Line: 43:0 - Index 382]
|- ---
|- This is word 6 of 6 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [$items)]
|- Current word:   [{] <---
|- Next word:      [
]
|- ---
|- State:     ELMT
|- Content:   [ foreach ($item in $items)]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is ELMT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 412
After advancing : 414

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 30
After advancing : 32

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [{]
-- }}} --

- Add a newline to content
- Add Line Feed
END OF LINE
-- }}} --
-- {{{ -Line------------------------------------------------------------------------------
No Carriage Return found
=================================== Line 044 ====================================
Current line: '\ \ \ \ Write-Output\ \$item'
Split line into 6 words
-- {{{ -Word '' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|      Write-Output $item
|  ^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (90) scanned in the input so far
|- Index:     16
|- Line:      44
|- Cursor:    414
|- Column:    0
|- ---
|- Start:    Line: 43:4 - Index 386]
|- End:      Line: 43:0 - Index 382]
|- ---
|- This is word 1 of 6 in this line
|- Is first word:  True
|- Is last word:  
|- Previous word:  [{]
|- Current word:   [] <---
|- Next word:      []
|- ---
|- State:     ELMT
|- Content:   [ foreach ($item in $items) {
]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: whitespace --
-- }}} --
- Store current word as prevWord
Finished scanning word []
-- }}} --

-- {{{ -Word '' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|      Write-Output $item
|  ^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (91) scanned in the input so far
|- Index:     16
|- Line:      44
|- Cursor:    414
|- Column:    0
|- ---
|- Start:    Line: 43:4 - Index 386]
|- End:      Line: 43:0 - Index 382]
|- ---
|- This is word 2 of 6 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  []
|- Current word:   [] <---
|- Next word:      []
|- ---
|- State:     ELMT
|- Content:   [ foreach ($item in $items) {
 ]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: whitespace --
-- }}} --
- Store current word as prevWord
Finished scanning word []
-- }}} --

-- {{{ -Word '' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|      Write-Output $item
|  ^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (92) scanned in the input so far
|- Index:     16
|- Line:      44
|- Cursor:    414
|- Column:    0
|- ---
|- Start:    Line: 43:4 - Index 386]
|- End:      Line: 43:0 - Index 382]
|- ---
|- This is word 3 of 6 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  []
|- Current word:   [] <---
|- Next word:      []
|- ---
|- State:     ELMT
|- Content:   [ foreach ($item in $items) {
  ]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: whitespace --
-- }}} --
- Store current word as prevWord
Finished scanning word []
-- }}} --

-- {{{ -Word '' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|      Write-Output $item
|  ^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (93) scanned in the input so far
|- Index:     16
|- Line:      44
|- Cursor:    414
|- Column:    0
|- ---
|- Start:    Line: 43:4 - Index 386]
|- End:      Line: 43:0 - Index 382]
|- ---
|- This is word 4 of 6 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  []
|- Current word:   [] <---
|- Next word:      [Write-Output]
|- ---
|- State:     ELMT
|- Content:   [ foreach ($item in $items) {
   ]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: whitespace --
-- }}} --
- Store current word as prevWord
Finished scanning word []
-- }}} --

-- {{{ -Word 'Write-Output' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|      Write-Output $item
|  ^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (94) scanned in the input so far
|- Index:     16
|- Line:      44
|- Cursor:    414
|- Column:    0
|- ---
|- Start:    Line: 43:4 - Index 386]
|- End:      Line: 43:0 - Index 382]
|- ---
|- This is word 5 of 6 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  []
|- Current word:   [Write-Output] <---
|- Next word:      [$item]
|- ---
|- State:     ELMT
|- Content:   [ foreach ($item in $items) {
    ]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is ELMT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 414
After advancing : 427

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 0
After advancing : 13

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [Write-Output]
-- }}} --

-- {{{ -Word '\$item' --
+-- {{{ -Column (13)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|      Write-Output $item
|  ------------^
+------------------------------------------------------ }}} --
- Last word in line
-- {{{ info block --
| This is word (95) scanned in the input so far
|- Index:     16
|- Line:      44
|- Cursor:    427
|- Column:    13
|- ---
|- Start:    Line: 43:4 - Index 386]
|- End:      Line: 43:0 - Index 382]
|- ---
|- This is word 6 of 6 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [Write-Output]
|- Current word:   [$item] <---
|- Next word:      [
]
|- ---
|- State:     ELMT
|- Content:   [ foreach ($item in $items) {
     Write-Output]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is ELMT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 427
After advancing : 433

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 13
After advancing : 19

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [$item]
-- }}} --

- Add a newline to content
- Add Line Feed
END OF LINE
-- }}} --
-- {{{ -Line------------------------------------------------------------------------------
No Carriage Return found
=================================== Line 045 ====================================
Current line: '}\ %>'
Split line into 2 words
-- {{{ -Word '}' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  } %>
|  ^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (96) scanned in the input so far
|- Index:     16
|- Line:      45
|- Cursor:    433
|- Column:    0
|- ---
|- Start:    Line: 43:4 - Index 386]
|- End:      Line: 43:0 - Index 382]
|- ---
|- This is word 1 of 2 in this line
|- Is first word:  True
|- Is last word:  
|- Previous word:  [$item]
|- Current word:   [}] <---
|- Next word:      [%>]
|- ---
|- State:     ELMT
|- Content:   [ foreach ($item in $items) {
     Write-Output $item
]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is ELMT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 433
After advancing : 434

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 0
After advancing : 1

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [}]
-- }}} --

-- {{{ -Word '%>' --
+-- {{{ -Column (1)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  } %>
|  ^
+------------------------------------------------------ }}} --
- Last word in line
-- {{{ info block --
| This is word (97) scanned in the input so far
|- Index:     16
|- Line:      45
|- Cursor:    434
|- Column:    1
|- ---
|- Start:    Line: 43:4 - Index 386]
|- End:      Line: 43:0 - Index 382]
|- ---
|- This is word 2 of 2 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [}]
|- Current word:   [%>] <---
|- Next word:      [
]
|- ---
|- State:     ELMT
|- Content:   [ foreach ($item in $items) {
     Write-Output $item
}]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: End Tag --
-- No characters found before end tag
Check condition when state is ELMT
-- {{{ END TAG :: default --
lexeme is [ %>]
- Advance the cursor and column by 3 to the end of the end tag

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 434
After advancing : 437

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 1
After advancing : 4

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
+-- {{{ -Column (4)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  } %>
|  ---^
+------------------------------------------------------ }}} --

--------------------------------------------------------------------------------
-- Begin Set-EndPosition
--------------------------------------------------------------------------------
Setting End Index => 437
Setting End Column => 4
Setting End Line => 45

--------------------------------------------------------------------------------
-- End Set-EndPosition
--------------------------------------------------------------------------------
**** Create Token ****

--------------------------------------------------------------------------------
-- Begin New-TemplateToken
Received : @{
    Indent = ''
    Suffix = ''
    Content = ' foreach ($item in $items) {
     Write-Output $item
}'
    RemainingWhiteSpace = ''
    Index = 16
    Prefix = ''
    Type = 'elmt'
    RemoveIndent = $false
    RemoveNewLine = $false
    End = @{
        Line = 45
        Index = 437
        Column = 4
    }
    Start = @{
        Line = 43
        Index = 386
        Column = 4
    }
}

Creating Token 16: TokenInfo :
 @{
    Suffix = ''
    Type = 'ELMT'
    Prefix = ''
    RemoveNewLine = $false
    PSTypeName = 'Stencil.TemplateToken.Elmt'
    Length = 54
    Indent = ''
    Start = @{
        Line = 43
        Index = 386
        Column = 4
    }
    End = @{
        Line = 45
        Index = 437
        Column = 4
    }
    RemainingWhiteSpace = ''
    Index = 16
    Content = ' foreach ($item in $items) {
     Write-Output $item
}'
    RemoveIndent = $false
}

-- End New-TemplateToken
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Reset-TokenOption
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- End Reset-TokenOption
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using Count parameter
Current cursor is : 437
After advancing : 438

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using Count parameter
Current column is : 4
After advancing : 5

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Set-StartPosition
--------------------------------------------------------------------------------
Setting Start Index => 438
Setting Start Column => 5
Setting Start Line => 45

--------------------------------------------------------------------------------
-- End Set-StartPosition
--------------------------------------------------------------------------------
STATE CHANGE: ELMT -> CLOSE
-------------------------------------------------------------------------}}} --
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [%>]
-- }}} --

- Add a newline to content
- Add Line Feed
END OF LINE
-- }}} --
-- {{{ -Line------------------------------------------------------------------------------
No Carriage Return found
=================================== Line 046 ====================================
Current line: ''
Split line into 1 words
-- {{{ -Word '' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  
|  ^
+------------------------------------------------------ }}} --
- Last word in line
-- {{{ info block --
| This is word (98) scanned in the input so far
|- Index:     17
|- Line:      46
|- Cursor:    438
|- Column:    0
|- ---
|- Start:    Line: 45:5 - Index 438]
|- End:      Line: 45:4 - Index 437]
|- ---
|- This is word 1 of 1 in this line
|- Is first word:  True
|- Is last word:  
|- Previous word:  [%>]
|- Current word:   [] <---
|- Next word:      [
]
|- ---
|- State:     CLOSE
|- Content:   [
]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: whitespace --
-- }}} --
- Store current word as prevWord
Finished scanning word []
-- }}} --

- Add a newline to content
- Add Line Feed
END OF LINE
-- }}} --
-- {{{ -Line------------------------------------------------------------------------------
No Carriage Return found
=================================== Line 047 ====================================
Current line: '<%-\ INCLUDE\ 'section-footer\.pst1'\ -Test1\ -Encoding\ UTF8\ %>'
Split line into 7 words
-- {{{ -Word '<%-' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%- INCLUDE 'section-footer.pst1' -Test1 -Encoding UTF8 %>
|  ^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (99) scanned in the input so far
|- Index:     17
|- Line:      47
|- Cursor:    438
|- Column:    0
|- ---
|- Start:    Line: 45:5 - Index 438]
|- End:      Line: 45:4 - Index 437]
|- ---
|- This is word 1 of 7 in this line
|- Is first word:  True
|- Is last word:  
|- Previous word:  []
|- Current word:   [<%-] <---
|- Next word:      [INCLUDE]
|- ---
|- State:     CLOSE
|- Content:   [
 
]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: Start tag --
- Characters found after start tag
Characters found is a Prefix
Check condition when state is CLOSE
-- {{{ START TAG :: default --
There is content from the previous block.  Create token
- Set End position for the previous content before advancing
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%- INCLUDE 'section-footer.pst1' -Test1 -Encoding UTF8 %>
|  ^
+------------------------------------------------------ }}} --

--------------------------------------------------------------------------------
-- Begin Set-EndPosition
--------------------------------------------------------------------------------
Setting End Index => 438
Setting End Column => 0
Setting End Line => 47

--------------------------------------------------------------------------------
-- End Set-EndPosition
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin New-TemplateToken
Received : @{
    Indent = ''
    Suffix = ''
    Content = '
 
'
    RemainingWhiteSpace = ''
    Index = 17
    Prefix = ''
    Type = 'text'
    RemoveIndent = $false
    RemoveNewLine = $false
    End = @{
        Line = 47
        Index = 438
        Column = 0
    }
    Start = @{
        Line = 45
        Index = 438
        Column = 5
    }
}

Creating Token 17: TokenInfo :
 @{
    Suffix = ''
    Type = 'TEXT'
    Prefix = ''
    RemoveNewLine = $false
    PSTypeName = 'Stencil.TemplateToken.Text'
    Length = 3
    Indent = ''
    Start = @{
        Line = 45
        Index = 438
        Column = 5
    }
    End = @{
        Line = 47
        Index = 438
        Column = 0
    }
    RemainingWhiteSpace = ''
    Index = 17
    Content = '
 
'
    RemoveIndent = $false
}

-- End New-TemplateToken
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 438
After advancing : 441

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 0
After advancing : 3

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Reset-TokenOption
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- End Reset-TokenOption
--------------------------------------------------------------------------------
+-- {{{ -Column (3)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%- INCLUDE 'section-footer.pst1' -Test1 -Encoding UTF8 %>
|  --^
+------------------------------------------------------ }}} --

--------------------------------------------------------------------------------
-- Begin Set-StartPosition
--------------------------------------------------------------------------------
Setting Start Index => 441
Setting Start Column => 3
Setting Start Line => 47

--------------------------------------------------------------------------------
-- End Set-StartPosition
--------------------------------------------------------------------------------
STATE CHANGE: CLOSE -> OPEN
- Store current word as prevWord
Finished scanning word [<%-]
-- }}} --

-- {{{ -Word 'INCLUDE' --
+-- {{{ -Column (3)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%- INCLUDE 'section-footer.pst1' -Test1 -Encoding UTF8 %>
|  --^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (100) scanned in the input so far
|- Index:     18
|- Line:      47
|- Cursor:    441
|- Column:    3
|- ---
|- Start:    Line: 47:3 - Index 441]
|- End:      Line: 47:0 - Index 438]
|- ---
|- This is word 2 of 7 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [<%-]
|- Current word:   [INCLUDE] <---
|- Next word:      ['section-footer.pst1']
|- ---
|- State:     OPEN
|- Content:   []
|- Prefix:    [-]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is OPEN
- state condition: OPEN
STATE CHANGE: OPEN -> ELMT
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 441
After advancing : 449

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 3
After advancing : 11

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [INCLUDE]
-- }}} --

-- {{{ -Word ''section-footer\.pst1'' --
+-- {{{ -Column (11)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%- INCLUDE 'section-footer.pst1' -Test1 -Encoding UTF8 %>
|  ----------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (101) scanned in the input so far
|- Index:     18
|- Line:      47
|- Cursor:    449
|- Column:    11
|- ---
|- Start:    Line: 47:3 - Index 441]
|- End:      Line: 47:0 - Index 438]
|- ---
|- This is word 3 of 7 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [INCLUDE]
|- Current word:   ['section-footer.pst1'] <---
|- Next word:      [-Test1]
|- ---
|- State:     ELMT
|- Content:   [ INCLUDE]
|- Prefix:    [-]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is ELMT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 449
After advancing : 471

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 11
After advancing : 33

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word ['section-footer.pst1']
-- }}} --

-- {{{ -Word '-Test1' --
+-- {{{ -Column (33)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%- INCLUDE 'section-footer.pst1' -Test1 -Encoding UTF8 %>
|  --------------------------------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (102) scanned in the input so far
|- Index:     18
|- Line:      47
|- Cursor:    471
|- Column:    33
|- ---
|- Start:    Line: 47:3 - Index 441]
|- End:      Line: 47:0 - Index 438]
|- ---
|- This is word 4 of 7 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  ['section-footer.pst1']
|- Current word:   [-Test1] <---
|- Next word:      [-Encoding]
|- ---
|- State:     ELMT
|- Content:   [ INCLUDE 'section-footer.pst1']
|- Prefix:    [-]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is ELMT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 471
After advancing : 478

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 33
After advancing : 40

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [-Test1]
-- }}} --

-- {{{ -Word '-Encoding' --
+-- {{{ -Column (40)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%- INCLUDE 'section-footer.pst1' -Test1 -Encoding UTF8 %>
|  ---------------------------------------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (103) scanned in the input so far
|- Index:     18
|- Line:      47
|- Cursor:    478
|- Column:    40
|- ---
|- Start:    Line: 47:3 - Index 441]
|- End:      Line: 47:0 - Index 438]
|- ---
|- This is word 5 of 7 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [-Test1]
|- Current word:   [-Encoding] <---
|- Next word:      [UTF8]
|- ---
|- State:     ELMT
|- Content:   [ INCLUDE 'section-footer.pst1' -Test1]
|- Prefix:    [-]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is ELMT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 478
After advancing : 488

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 40
After advancing : 50

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [-Encoding]
-- }}} --

-- {{{ -Word 'UTF8' --
+-- {{{ -Column (50)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%- INCLUDE 'section-footer.pst1' -Test1 -Encoding UTF8 %>
|  -------------------------------------------------^
+------------------------------------------------------ }}} --
-- {{{ info block --
| This is word (104) scanned in the input so far
|- Index:     18
|- Line:      47
|- Cursor:    488
|- Column:    50
|- ---
|- Start:    Line: 47:3 - Index 441]
|- End:      Line: 47:0 - Index 438]
|- ---
|- This is word 6 of 7 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [-Encoding]
|- Current word:   [UTF8] <---
|- Next word:      [%>]
|- ---
|- State:     ELMT
|- Content:   [ INCLUDE 'section-footer.pst1' -Test1 -Encoding]
|- Prefix:    [-]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: default ---------------------------------------------------------
Check condition when state is ELMT
- state condition: default
- Adding to content

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 488
After advancing : 493

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 50
After advancing : 55

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
- Reset Indent
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [UTF8]
-- }}} --

-- {{{ -Word '%>' --
+-- {{{ -Column (55)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%- INCLUDE 'section-footer.pst1' -Test1 -Encoding UTF8 %>
|  ------------------------------------------------------^
+------------------------------------------------------ }}} --
- Last word in line
-- {{{ info block --
| This is word (105) scanned in the input so far
|- Index:     18
|- Line:      47
|- Cursor:    493
|- Column:    55
|- ---
|- Start:    Line: 47:3 - Index 441]
|- End:      Line: 47:0 - Index 438]
|- ---
|- This is word 7 of 7 in this line
|- Is first word:  False
|- Is last word:  
|- Previous word:  [UTF8]
|- Current word:   [%>] <---
|- Next word:      [
]
|- ---
|- State:     ELMT
|- Content:   [ INCLUDE 'section-footer.pst1' -Test1 -Encoding UTF8]
|- Prefix:    [-]
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: End Tag --
-- No characters found before end tag
Check condition when state is ELMT
-- {{{ END TAG :: default --
lexeme is [ %>]
- Advance the cursor and column by 3 to the end of the end tag

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using lexeme length
Current cursor is : 493
After advancing : 496

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using lexeme length
Current column is : 55
After advancing : 58

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------
+-- {{{ -Column (58)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  <%- INCLUDE 'section-footer.pst1' -Test1 -Encoding UTF8 %>
|  ---------------------------------------------------------^
+------------------------------------------------------ }}} --

--------------------------------------------------------------------------------
-- Begin Set-EndPosition
--------------------------------------------------------------------------------
Setting End Index => 496
Setting End Column => 58
Setting End Line => 47

--------------------------------------------------------------------------------
-- End Set-EndPosition
--------------------------------------------------------------------------------
**** Create Token ****

--------------------------------------------------------------------------------
-- Begin New-TemplateToken
Received : @{
    Indent = ''
    Suffix = ''
    Content = ' INCLUDE ''section-footer.pst1'' -Test1 -Encoding UTF8'
    RemainingWhiteSpace = ''
    Index = 18
    Prefix = '-'
    Type = 'elmt'
    RemoveIndent = $false
    RemoveNewLine = $false
    End = @{
        Line = 47
        Index = 496
        Column = 58
    }
    Start = @{
        Line = 47
        Index = 441
        Column = 3
    }
}

Creating Token 18: TokenInfo :
 @{
    Suffix = ''
    Type = 'ELMT'
    Prefix = '-'
    RemoveNewLine = $false
    PSTypeName = 'Stencil.TemplateToken.Elmt'
    Length = 52
    Indent = ''
    Start = @{
        Line = 47
        Index = 441
        Column = 3
    }
    End = @{
        Line = 47
        Index = 496
        Column = 58
    }
    RemainingWhiteSpace = ''
    Index = 18
    Content = ' INCLUDE ''section-footer.pst1'' -Test1 -Encoding UTF8'
    RemoveIndent = $true
}

-- End New-TemplateToken
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Reset-TokenOption
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- End Reset-TokenOption
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Cursor
--------------------------------------------------------------------------------
- Using Count parameter
Current cursor is : 496
After advancing : 497

--------------------------------------------------------------------------------
-- End Update-Cursor
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Update-Column
--------------------------------------------------------------------------------
- Using Count parameter
Current column is : 58
After advancing : 59

--------------------------------------------------------------------------------
-- End Update-Column
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Set-StartPosition
--------------------------------------------------------------------------------
Setting Start Index => 497
Setting Start Column => 59
Setting Start Line => 47

--------------------------------------------------------------------------------
-- End Set-StartPosition
--------------------------------------------------------------------------------
STATE CHANGE: ELMT -> CLOSE
-------------------------------------------------------------------------}}} --
----------------------------------------------------------------------- }}} --
- Store current word as prevWord
Finished scanning word [%>]
-- }}} --

- Add a newline to content
- Add Line Feed
END OF LINE
-- }}} --
-- {{{ -Line------------------------------------------------------------------------------
No Carriage Return found
=================================== Line 048 ====================================
Current line: ''
Split line into 1 words
-- {{{ -Word '' --
+-- {{{ -Column (0)--------------------------------------
|- 0    5   10    15   20   25   30   35   40   45   50   55
|- |....|....|....|....|....|....|....|....|....|....|....|
|  
|  ^
+------------------------------------------------------ }}} --
- Last word in line
-- {{{ info block --
| This is word (106) scanned in the input so far
|- Index:     19
|- Line:      48
|- Cursor:    497
|- Column:    0
|- ---
|- Start:    Line: 47:59 - Index 497]
|- End:      Line: 47:58 - Index 496]
|- ---
|- This is word 1 of 1 in this line
|- Is first word:  True
|- Is last word:  
|- Previous word:  [%>]
|- Current word:   [] <---
|- Next word:      [
]
|- ---
|- State:     CLOSE
|- Content:   [
]
|- Prefix:    []
|- Suffix:    []
-- }}} --
-------------------------------------------------
-- {{{ SCAN: whitespace --
-- }}} --
- Store current word as prevWord
Finished scanning word []
-- }}} --

- Add a newline to content
- Add Line Feed
END OF LINE
-- }}} --
END OF INPUT
- There is remaining content
Check condition when state is CLOSE
- default

--------------------------------------------------------------------------------
-- Begin Set-EndPosition
--------------------------------------------------------------------------------
Setting End Index => 497
Setting End Column => 0
Setting End Line => 48

--------------------------------------------------------------------------------
-- End Set-EndPosition
--------------------------------------------------------------------------------
**** Create Token ****

--------------------------------------------------------------------------------
-- Begin New-TemplateToken
Received : @{
    Indent = ''
    Suffix = ''
    Content = '
 
'
    RemainingWhiteSpace = ''
    Index = 19
    Prefix = ''
    Type = 'text'
    RemoveIndent = $false
    RemoveNewLine = $false
    End = @{
        Line = 48
        Index = 497
        Column = 0
    }
    Start = @{
        Line = 47
        Index = 497
        Column = 59
    }
}

Creating Token 19: TokenInfo :
 @{
    Suffix = ''
    Type = 'TEXT'
    Prefix = ''
    RemoveNewLine = $false
    PSTypeName = 'Stencil.TemplateToken.Text'
    Length = 3
    Indent = ''
    Start = @{
        Line = 47
        Index = 497
        Column = 59
    }
    End = @{
        Line = 48
        Index = 497
        Column = 0
    }
    RemainingWhiteSpace = ''
    Index = 19
    Content = '
 
'
    RemoveIndent = $false
}

-- End New-TemplateToken
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- Begin Reset-TokenOption
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- End Reset-TokenOption
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- End Convert-StringToToken
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- End ConvertFrom-StencilTemplate
--------------------------------------------------------------------------------
